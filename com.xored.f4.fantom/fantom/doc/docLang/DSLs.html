<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
  <title>DSLs</title>
  <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
  <link rel='stylesheet' type='text/css' href='../doc.css'/>
  <script type='text/javascript' src='../doc.js'></script>
<!--[if lt IE 7]>
<script src='http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js' type='text/javascript'></script>
<![endif]-->
</head>
<body onload='Login.check();'>
<div class='header'>
<div>
<h1><a href='/'>Fantom</a></h1>
<p id='sidewalkLogin_'>&nbsp;</p>
<form method='get' action='/sidewalk/search/'>
<p>
<input type='text' name='q' size='30' value='Search...' onfocus='if (value=="Search...") value=""' onblur='if (value=="") value="Search..."' />
</p>
</form>
<ul>
<li><a href='/'>Home</a></li>
<li class='active'><a href='../index.html'>Docs</a></li>
<li><a href='/sidewalk/blog/'>Blog</a></li>
<li><a href='/sidewalk/ticket/'>Tickets</a></li>
<li><a href='/sidewalk/topic/'>Discuss</a></li>
</ul></div>
</div>
<div class='subHeader'>
<div>
<ul>
  <li><a href='../index.html'>Doc Home</a></li>
  <li>&gt;</li>
  <li><a href='index.html'>docLang</a></li>
  <li>&gt;</li>
  <li><a href='DSLs.html'>DSLs</a></li>
</ul>
</div>
</div>
<div class='content'>
<div>
<div class='fandoc'>
<div class='prevNext'>
<div class='prev'><a href='Localization.html'><img src='../go-previous.png' alt='prev' /></a> <a href='Localization.html'>Localization</a></div>
<div class='next'><a href='DateTime.html'>Date Time</a> <a href='DateTime.html'><img src='../go-next.png' alt='next' /></a></div>
</div>
<h1 class='title'>DSLs</h1>

<h1 id='overview'>Overview </h1>

<p>DSLs or Domain Specific Languages allow you to embed other languages into your Fantom source code.  The syntax for a DSL is:</p>

<pre>AnchorType &lt;|...|></pre>

<p>Everything between the <code>&lt;|</code> and <code>|></code> tokens is considered source code of the DSL itself.  The anchor type defines how to the compile the DSL. DslPlugins are registered on the anchor type, and called by the Fantom compiler to translate them into a Fantom expression.</p>

<h1 id='builtIn'>Built-in DSLs </h1>

<p>Fantom currently ships with these DSLs:</p>

<h2 id='str'>Str DSL </h2>

<p>You can use the Str DSL to write strings which contain any character other than the "|>" sequence.  They work similar to a XML CDATA section or here-documents in languages like Perl, Python, or Ruby:</p>

<pre>echo(Str &lt;|no \ or $ escapes need, and
           multi-line works too|>)</pre>

<p>See the <a href='Literals.html#strDsl'>Str Literals</a> for more details.</p>

<h2 id='regex'>Regex DSL </h2>

<p>You can use the Regex DSL to construct a <code><a href='../sys/Regex.html'>sys::Regex</a></code> instance with a string pattern:</p>

<pre>Regex &lt;|foo|foo/(\d*)|></pre>

<p>You don't need to worry about escaping special characters like the backslash.</p>

<h1 id='dslPlugins'>DslPlugins </h1>

<p>You can write your own DSLs by subclassing <code><a href='../compiler/DslPlugin.html'>compiler::DslPlugin</a></code>. See the <code>RegexDslPlugin</code> class as a simple example to get started:</p>

<pre>@compilerDsl="sys::Regex"
class RegexDslPlugin : DslPlugin
{
  new make(Compiler c) : super(c) {}

  override Expr compile(DslExpr dsl)
  {
    regexType := ns.resolveType("sys::Regex")
    fromStr := regexType.method("fromStr")
    args := [LiteralExpr.makeFor(dsl.location, ns, dsl.src)]
    return CallExpr.makeWithMethod(dsl.location, null, fromStr, args)
  }
}</pre>

<p>Note: writing plugins requires accessing the compiler APIs. This API has a very large surface area, so we cannot guarantee that these APIs won't change in the future.</p>
<div class='prevNext'>
<div class='prev'><a href='Localization.html'><img src='../go-previous.png' alt='prev' /></a> <a href='Localization.html'>Localization</a></div>
<div class='next'><a href='DateTime.html'>Date Time</a> <a href='DateTime.html'><img src='../go-next.png' alt='next' /></a></div>
</div>
</div>
<div class='sidebar'>
<h2>Contents</h2>
<ul>
<li><a href='#overview'>Overview </a></li><li><a href='#builtIn'>Built-in DSLs </a><ul>
<li><a href='#str'>Str DSL </a></li><li><a href='#regex'>Regex DSL </a></li></ul>
</li><li><a href='#dslPlugins'>DslPlugins </a></li></ul>
</div>
</div>
</div>
<div class='footer'>
<div>
<p>
docLang 1.0.56
[11-Nov-2010 Thu 10:08:28AM EST]
</p>
</div>
</div>
</body>
</html>
