<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
  <title>Localization</title>
  <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
  <link rel='stylesheet' type='text/css' href='../doc.css'/>
  <script type='text/javascript' src='../doc.js'></script>
<!--[if lt IE 7]>
<script src='http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js' type='text/javascript'></script>
<![endif]-->
</head>
<body onload='Login.check();'>
<div class='header'>
<div>
<h1><a href='/'>Fantom</a></h1>
<p id='sidewalkLogin_'>&nbsp;</p>
<form method='get' action='/sidewalk/search/'>
<p>
<input type='text' name='q' size='30' value='Search...' onfocus='if (value=="Search...") value=""' onblur='if (value=="") value="Search..."' />
</p>
</form>
<ul>
<li><a href='/'>Home</a></li>
<li class='active'><a href='../index.html'>Docs</a></li>
<li><a href='/sidewalk/blog/'>Blog</a></li>
<li><a href='/sidewalk/ticket/'>Tickets</a></li>
<li><a href='/sidewalk/topic/'>Discuss</a></li>
</ul></div>
</div>
<div class='subHeader'>
<div>
<ul>
  <li><a href='../index.html'>Doc Home</a></li>
  <li>&gt;</li>
  <li><a href='index.html'>docLang</a></li>
  <li>&gt;</li>
  <li><a href='Localization.html'>Localization</a></li>
</ul>
</div>
</div>
<div class='content'>
<div>
<div class='fandoc'>
<div class='prevNext'>
<div class='prev'><a href='Logging.html'><img src='../go-previous.png' alt='prev' /></a> <a href='Logging.html'>Logging</a></div>
<div class='next'><a href='DSLs.html'>DSLs</a> <a href='DSLs.html'><img src='../go-next.png' alt='next' /></a></div>
</div>
<h1 class='title'>Localization</h1>

<h1 id='locale'>Locale </h1>

<p>The <code><a href='../sys/Locale.html'>sys::Locale</a></code> class is the hub API for Fantom's localization infrastructure.  Locales are used to represent a language via an ISO 639 two letter code.  A locale may also optionally represent a specific country or region via a ISO 3166 two letter code.  Common locales include:</p>

<pre>Language Only:
  en     English
  es     Spanish
  fr     French
  de     German
  it     Italian
  ja     Japanese
  ko     Korean
  zh     Chinese
Language and Country:
  en-US  United States
  en-GB  United Kingdom
  es-ES  Spain
  es-MX  Mexico
  fr-FR  France
  de-DE  Germany
  en-CA  Canada (English)
  fr-CA  Canada (French)
  zh-CN  China (Simplified)
  zh-TW  Taiwan</pre>

<p>When the Fantom VM is started it will create a default locale based on the underlying platform.  For example on a Java VM, the default Fantom locale will be initialized from <code>java.util.Locale</code> (which in turn is initialized from the operating system's default locale).</p>

<p>Locales are configured as an actor local variable.  Use <code><a href='../sys/Locale.html#cur'>sys::Locale.cur</a></code> and <code><a href='../sys/Locale.html#setCur'>sys::Locale.setCur</a></code> to get and set the current thread's locale.</p>

<p>By convention <code>Locale</code> is never passed as a parameter to Fantom APIs.  Rather the locale is implied by the current actor.  As a general rule APIs which are locale sensitive will include the term <code>locale</code> in their method name.</p>

<p>Use <code><a href='../sys/Locale.html#use'>Locale.use</a></code> to execute a body of code using a different locale:</p>

<pre>echo(Locale.cur)
Locale("zh-CN").use {  echo(Locale.cur) }
echo(Locale.cur)</pre>

<h1 id='props'>Localized Properties </h1>

<p>All the strings displayed to users should typically be pulled out into <em>localized props files</em> to enable easy language translation.  Each pod may define one localized property map with as many keys are desired. Localized properties are defined in <code><a href='../sys/InStream.html#readProps'>props files</a></code> as pod resource files under the <code>locale</code> directory.  An example set of localized props files:</p>

<pre>locale/en.props
locale/en-US.props
locale/en-CA.props
locale/fr.props
locale/fr-CA.props</pre>

<p>The <code><a href='../sys/Env.html#locale'>sys::Env.locale</a></code> API is used to lookup a localized property. Typically you will use the <code><a href='../sys/Pod.html#locale'>Pod.locale</a></code> convenience method:</p>

<pre>Button(pod.locale("ok"))
Button(pod.locale("cancel"))</pre>

<p>Looking up localization is delegated to the current <code><a href='../sys/Env.html'>Env</a></code>. But the standard resolution rules are:</p>

<ol style='list-style-type:decimal'>
<li><code>Env.props(pod, `locale/{locale}.props`)</code></li>

<li><code>Env.props(pod, `locale/{lang}.props`)</code></li>

<li><code>Env.props(pod, `locale/en.props`)</code></li>

<li>Fallback to <code>pod::key</code> unless <code>def</code> specified</li>
</ol>

<p><code><a href='../sys/Env.html#props'>Env.props</a></code> first looks in the pod's etc directory for overrides, then checks if the pod contains a resource file.</p>

<p>Best practice is to ensure that all properties are mapped in <code>en.props</code> file as your fallback defaults.  Then store localized translations in language files such as <code>fr.props</code>, <code>de.props</code>, etc.  Typically you will only use country specific files such as <code>en-US</code> or <code>en-GB</code> for regional terms.</p>

<h1 id='localeLiterals'>Locale Literals </h1>

<p>String interpolation supports a special mode used to make working with localized props easy.  The following interpolation formats are supported:</p>

<ul>
<li><code>$&lt;key></code> unqualified key</li>

<li><code>$&lt;pod::key></code> qualified key</li>

<li><code>$&lt;key=def></code> unqualified key with default value</li>
</ul>

<p>The simplest locale literal is an unqualified key which is just a shortcut for <code><a href='../sys/Pod.html#locale'>sys::Pod.locale</a></code> using the enclosing type:</p>

<pre>// original code
class Foo { Void main() { echo("$&lt;bar.baz>") } }

// translated into
class Foo { Void main() { echo(#Foo.pod.locale("bar.baz")) } }</pre>

<p>You can also use a qualified key to lookup a localized prop in an external pod:</p>

<pre>// original code
"$&lt;fwt::cancel.name>"

// translated into
Pod.find("fwt").locale("cancel.name")</pre>

<p>The last format lets you actually define the key's value right in your Fantom source code:</p>

<pre>// orginal code
"$&lt;fileNotFound=File not found>: $file"

// translates into
EnclosingType#.pod.locale("fileNotFound", "File not found") + ": $file"

// and automatically adds the key/value pair to locale/en.props
fileNotFound=File not found</pre>

<p>If your pod doesn't have an explicit "locale/en.props" resource then it is automatically created.  If it does exist then interpolated key/values are automatically merged into the existing props file.  It is a compile time error to declare a key's value in multiple places; each key must be defined exactly once in either en.props or in an interpolated string.</p>
<div class='prevNext'>
<div class='prev'><a href='Logging.html'><img src='../go-previous.png' alt='prev' /></a> <a href='Logging.html'>Logging</a></div>
<div class='next'><a href='DSLs.html'>DSLs</a> <a href='DSLs.html'><img src='../go-next.png' alt='next' /></a></div>
</div>
</div>
<div class='sidebar'>
<h2>Contents</h2>
<ul>
<li><a href='#locale'>Locale </a></li><li><a href='#props'>Localized Properties </a></li><li><a href='#localeLiterals'>Locale Literals </a></li></ul>
</div>
</div>
</div>
<div class='footer'>
<div>
<p>
docLang 1.0.56
[11-Nov-2010 Thu 10:08:28AM EST]
</p>
</div>
</div>
</body>
</html>
