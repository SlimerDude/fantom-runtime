<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
  <title>Logging</title>
  <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
  <link rel='stylesheet' type='text/css' href='../doc.css'/>
  <script type='text/javascript' src='../doc.js'></script>
<!--[if lt IE 7]>
<script src='http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js' type='text/javascript'></script>
<![endif]-->
</head>
<body onload='Login.check();'>
<div class='header'>
<div>
<h1><a href='/'>Fantom</a></h1>
<p id='sidewalkLogin_'>&nbsp;</p>
<form method='get' action='/sidewalk/search/'>
<p>
<input type='text' name='q' size='30' value='Search...' onfocus='if (value=="Search...") value=""' onblur='if (value=="") value="Search..."' />
</p>
</form>
<ul>
<li><a href='/'>Home</a></li>
<li class='active'><a href='../index.html'>Docs</a></li>
<li><a href='/sidewalk/blog/'>Blog</a></li>
<li><a href='/sidewalk/ticket/'>Tickets</a></li>
<li><a href='/sidewalk/topic/'>Discuss</a></li>
</ul></div>
</div>
<div class='subHeader'>
<div>
<ul>
  <li><a href='../index.html'>Doc Home</a></li>
  <li>&gt;</li>
  <li><a href='index.html'>docLang</a></li>
  <li>&gt;</li>
  <li><a href='Logging.html'>Logging</a></li>
</ul>
</div>
</div>
<div class='content'>
<div>
<div class='fandoc'>
<div class='prevNext'>
<div class='prev'><a href='Naming.html'><img src='../go-previous.png' alt='prev' /></a> <a href='Naming.html'>Naming</a></div>
<div class='next'><a href='Localization.html'>Localization</a> <a href='Localization.html'><img src='../go-next.png' alt='next' /></a></div>
</div>
<h1 class='title'>Logging</h1>

<h1 id='creation'>Log Creation </h1>

<p>The <code><a href='../sys/Log.html'>sys::Log</a></code> class standardizes how to embed logging statements into Fantom applications.  Every <code>Log</code> instance in the VM has a unique name which by convention always starts with the pod name and uses dot separators.  Once a Log instance has been created for a specified name, it remains bound to that name for the lifetime of the VM.  Logs are const, immutable instances shared by all threads.</p>

<p>Most of the time, you should just use <code><a href='../sys/Pod.html#log'>Pod.log</a></code> to get the standard log for your pod:</p>

<pre>Pod.of(this).log.err("...")</pre>

<p>You can also use <code><a href='../sys/Log.html#get'>Log.get</a></code> which will create the Log on the first call, and look it up on subsequent calls:</p>

<pre>// get or create a log named "acme"
const static Log log = Log.get("acme")

// find an existing log
Log.find("acme")          // throw exception if not found
Log.find("acme", false)   // return null if not found

// list all the active logs
Log.list</pre>

<h1 id='statements'>Log Statements </h1>

<p>The following methods are used to generate log records:</p>

<ul>
<li><code><a href='../sys/Log.html#err'>Log.err</a></code>: something bad happened</li>

<li><code><a href='../sys/Log.html#warn'>Log.warn</a></code>: something happened which might be bad</li>

<li><code><a href='../sys/Log.html#info'>Log.info</a></code>: something interesting happened</li>

<li><code><a href='../sys/Log.html#debug'>Log.debug</a></code>: something happened which is interesting only if you happen to be debugging</li>
</ul>

<p>All logging methods take a <code>Str</code> message, and an optional <code>Err</code>. Some simple examples:</p>

<pre>log.err("The freaking file didn't load", err)
log.info("CatchRoadRoader service started on port $port")</pre>

<p>When writing debug log statements, we expect that they will be turned off most of the time.  Therefore be aware of the hidden costs of string concatenation.  You can use the <code><a href='../sys/Log.html#isDebug'>isDebug</a></code> method to skip creating a log message:</p>

<pre>// this code performs string concatenation on every call
log.debug("The values are x=$x, y=$y, and z=$z")

// this code performs string concatenation only when needed
if (log.isDebug)
  log.debug("The values are x=$x, y=$y, and z=$z")</pre>

<h1 id='levels'>Log Levels </h1>

<p>Each Log is configured to log events at or above a given <code><a href='../sys/LogLevel.html'>LogLevel</a></code>.  These levels from least to most severe:</p>

<ul>
<li><strong>debug</strong>: log everything</li>

<li><strong>info</strong>: log everything but debug</li>

<li><strong>warn</strong>: log everything but debug, info</li>

<li><strong>err</strong>: log only errors</li>

<li><strong>silent</strong>: log nothing</li>
</ul>

<p>All logs default to level <code>info</code> (see <a href='#setup'>setup</a> to change default levels).</p>

<p>You can get/set the current severity level of a Log via the <code><a href='../sys/Log.html#level'>level</a></code> field.  Some code examples:</p>

<pre>log.level = LogLevel.warn
log.level &lt; LogLevel.err    // returns true
log.level &lt; LogLevel.info     // returns false</pre>

<h1 id='handlers'>Log Handlers </h1>

<p>Log handlers are functions designed to process <code><a href='../sys/LogRec.html'>LogRecs</a></code>. The following <code>Log</code> methods are used to manage the handlers in a VM:</p>

<ul>
<li><code><a href='../sys/Log.html#handlers'>Log.handlers</a></code>: list the installed handler functions</li>

<li><code><a href='../sys/Log.html#addHandler'>Log.addHandler</a></code>: install a handler function</li>

<li><code><a href='../sys/Log.html#removeHandler'>Log.removeHandler</a></code>: uninstall a handler function</li>
</ul>

<p>Handlers must be an instance of an <a href='Functions.html#immutable'>immutable Func</a> (they are shared by all threads).  On startup there is always one handler installed which will print each record to the console via the <code><a href='../sys/LogRec.html#print'>LogRec.print</a></code> method.</p>

<p>Here is a simple example of an installing a handler:</p>

<pre>Log.addHandler |rec| { echo("My Handler: $rec") }</pre>

<h1 id='setup'>Log Setup </h1>

<p>By default all log levels will default to <code>info</code>.  You can programatically change the level via <code><a href='../sys/Log.html#level'>Log.level</a></code>.   You can also use the "etc/sys/log.props" file to setup the default level for any log.  The "log.props" file is a standard props file where the log name is the key and the value is a String <code>LogLevel</code>:</p>

<pre>web=debug
acmeWombat.requests=silent
acmeWombat.responses=warn</pre>
<div class='prevNext'>
<div class='prev'><a href='Naming.html'><img src='../go-previous.png' alt='prev' /></a> <a href='Naming.html'>Naming</a></div>
<div class='next'><a href='Localization.html'>Localization</a> <a href='Localization.html'><img src='../go-next.png' alt='next' /></a></div>
</div>
</div>
<div class='sidebar'>
<h2>Contents</h2>
<ul>
<li><a href='#creation'>Log Creation </a></li><li><a href='#statements'>Log Statements </a></li><li><a href='#levels'>Log Levels </a></li><li><a href='#handlers'>Log Handlers </a></li><li><a href='#setup'>Log Setup </a></li></ul>
</div>
</div>
</div>
<div class='footer'>
<div>
<p>
docLang 1.0.56
[11-Nov-2010 Thu 10:08:28AM EST]
</p>
</div>
</div>
</body>
</html>
