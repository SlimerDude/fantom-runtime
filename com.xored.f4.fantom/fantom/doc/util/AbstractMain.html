<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
  <title>util::AbstractMain</title>
  <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
  <link rel='stylesheet' type='text/css' href='../doc.css'/>
  <script type='text/javascript' src='../doc.js'></script>
<!--[if lt IE 7]>
<script src='http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js' type='text/javascript'></script>
<![endif]-->
</head>
<body onload='Login.check();'>
<div class='header'>
<div>
<h1><a href='/'>Fantom</a></h1>
<p id='sidewalkLogin_'>&nbsp;</p>
<form method='get' action='/sidewalk/search/'>
<p>
<input type='text' name='q' size='30' value='Search...' onfocus='if (value=="Search...") value=""' onblur='if (value=="") value="Search..."' />
</p>
</form>
<ul>
<li><a href='/'>Home</a></li>
<li class='active'><a href='../index.html'>Docs</a></li>
<li><a href='/sidewalk/blog/'>Blog</a></li>
<li><a href='/sidewalk/ticket/'>Tickets</a></li>
<li><a href='/sidewalk/topic/'>Discuss</a></li>
</ul></div>
</div>
<div class='subHeader'>
<div>
<ul>
  <li><a href='../index.html'>Doc Home</a></li>
  <li>&gt;</li>
  <li><a href='index.html'>util</a></li>
  <li>&gt;</li>
  <li><a href='AbstractMain.html'>AbstractMain</a></li>
</ul>
</div>
</div>
<div class='content'>
<div>
<div class='fandoc'>
<div class='type'>
<div class='overview'>
<h2>abstract class</h2>
<h1>util::AbstractMain</h1>
<pre><a href='../sys/Obj.html'>sys::Obj</a>
  util::AbstractMain</pre>
</div>
<div class='detail'>

<p>AbstractMain provides conveniences for writing the main routine of an app. Command line arguments are configured as fields with the <code><a href='Arg.html'>Arg</a></code> facet:</p>

<pre>@Arg { help = "source file to process" }
File? src</pre>

<p>Arguments are ordered by the field declaration order.  The last argument may be declared as a list to handle a variable numbers of arguments.</p>

<p>Command line options are configured as fields with the <code><a href='Opt.html'>Opt</a></code> facet :</p>

<pre>@Opt { help = "http port"; aliases=["p"] }
Int port := 8080</pre>

<p>Bool fields should always default to false and are considered flag options.  All other arg and opt fields must be a Str, File, or have a type which supports a <code>fromStr</code> method.</p>

<p>Option fields may include the "Opt" suffix, and arguments the "Arg" suffix.  These suffixes can be used when a field conflicts with an existing slot name.</p>

<p>AbstractMain will automatically implement <a href='AbstractMain.html#usage'>usage</a> and <a href='AbstractMain.html#parseArgs'>parseArgs</a> based on the fields which are declared as options and arguments.  In general subclasses only need to override <a href='AbstractMain.html#run'>run</a>. If writing a daemon main, then you'll probably want to configure your services then call <a href='AbstractMain.html#runServices'>runServices</a>.</p>

<p>See <a href='../examples/util-main.html'>example</a>.</p>
</div>
</div>
<div class='slots'>
<div class='detail'>
<h2>Slots</h2>
<dl>
<dt id='appName' class='method'>appName<a href='AbstractMain_src.html#appName'>Source</a></dt>
<dd>
<p><code class='sig'>virtual <a href='../sys/Str.html'>Str</a> appName()</code></p>

<p>Get the application name.  If this is a script it is the name of the script file.  For a precompiled class called "Main" this is the pod name, otherwise it is the type name.</p>
</dd>
<dt id='argFields' class='method'>argFields<a href='AbstractMain_src.html#argFields'>Source</a></dt>
<dd>
<p><code class='sig'>virtual <a href='../sys/Field.html'>Field</a>[] argFields()</code></p>

<p>Get all the fields annotated with the <code>@arg</code> facet.</p>
</dd>
<dt id='argName' class='method hidden'>argName<a href='AbstractMain_src.html#argName'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>private <a href='../sys/Str.html'>Str</a> argName(<a href='../sys/Field.html'>Field</a> f)</code></p>
</dd>
<dt id='helpOpt' class='field'>helpOpt<a href='AbstractMain_src.html#helpOpt'>Source</a></dt>
<dd>
<p><code class='sig'>@<a href='Opt.html'>Opt</a> <br/>
<a href='../sys/Bool.html'>Bool</a> helpOpt := false</code></p>

<p>Print usage help.</p>
</dd>
<dt id='homeDir' class='method'>homeDir<a href='AbstractMain_src.html#homeDir'>Source</a></dt>
<dd>
<p><code class='sig'>virtual <a href='../sys/File.html'>File</a> homeDir()</code></p>

<p>Home directory for the application.  For a script this defaults to directory of the script.  For pods the default is "{Env.cur.workDir}/etc/{pod}".</p>
</dd>
<dt id='log' class='method'>log<a href='AbstractMain_src.html#log'>Source</a></dt>
<dd>
<p><code class='sig'>virtual <a href='../sys/Log.html'>Log</a> log()</code></p>

<p>Log for this application; defaults to <a href='AbstractMain.html#appName'>appName</a>.</p>
</dd>
<dt id='main' class='method'>main<a href='AbstractMain_src.html#main'>Source</a></dt>
<dd>
<p><code class='sig'>virtual <a href='../sys/Int.html'>Int</a> main(<a href='../sys/Str.html'>Str</a>[] args := Env.cur().args())</code></p>

<p>Main performs the following tasks:</p>

<ol style='list-style-type:decimal'>
<li>Calls <a href='AbstractMain.html#parseArgs'>parseArgs</a> to parse command line</li>

<li>If args were incomplete or -help was specified then dump usage and return 1</li>

<li>Call <a href='AbstractMain.html#run'>run</a> and return 0</li>

<li>If an exception is raised log it and return 1</li>
</ol>
</dd>
<dt id='optFields' class='method'>optFields<a href='AbstractMain_src.html#optFields'>Source</a></dt>
<dd>
<p><code class='sig'>virtual <a href='../sys/Field.html'>Field</a>[] optFields()</code></p>

<p>Get all the fields annotated with the <code>@opt</code> facet.</p>
</dd>
<dt id='optName' class='method hidden'>optName<a href='AbstractMain_src.html#optName'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>private <a href='../sys/Str.html'>Str</a> optName(<a href='../sys/Field.html'>Field</a> f)</code></p>
</dd>
<dt id='parseArg' class='method hidden'>parseArg<a href='AbstractMain_src.html#parseArg'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>private <a href='../sys/Bool.html'>Bool</a> parseArg(<a href='../sys/Field.html'>Field</a> field, <a href='../sys/Str.html'>Str</a> tok)</code></p>
</dd>
<dt id='parseArgs' class='method'>parseArgs<a href='AbstractMain_src.html#parseArgs'>Source</a></dt>
<dd>
<p><code class='sig'>virtual <a href='../sys/Bool.html'>Bool</a> parseArgs(<a href='../sys/Str.html'>Str</a>[] toks)</code></p>

<p>Parse the command line and set this instances fields. Return false if not all of the arguments were passed.</p>
</dd>
<dt id='parseOpt' class='method hidden'>parseOpt<a href='AbstractMain_src.html#parseOpt'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>private <a href='../sys/Bool.html'>Bool</a> parseOpt(<a href='../sys/Field.html'>Field</a>[] opts, <a href='../sys/Str.html'>Str</a> tok, <a href='../sys/Str.html'>Str</a>? next)</code></p>
</dd>
<dt id='parseVal' class='method hidden'>parseVal<a href='AbstractMain_src.html#parseVal'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>private <a href='../sys/Obj.html'>Obj</a>? parseVal(<a href='../sys/Type.html'>Type</a> of, <a href='../sys/Str.html'>Str</a> tok)</code></p>
</dd>
<dt id='run' class='method'>run<a href='AbstractMain_src.html#run'>Source</a></dt>
<dd>
<p><code class='sig'>abstract <a href='../sys/Int.html'>Int</a> run()</code></p>

<p>Run the application.  This method is called after the command line has been parsed.  See <a href='AbstractMain.html#runServices'>runServices</a> to launch a deamon application.  Return status code, zero for success.</p>
</dd>
<dt id='runServices' class='method'>runServices<a href='AbstractMain_src.html#runServices'>Source</a></dt>
<dd>
<p><code class='sig'>virtual <a href='../sys/Int.html'>Int</a> runServices(<a href='../sys/Service.html'>Service</a>[] services)</code></p>

<p>Run the set of services:</p>

<ol style='list-style-type:decimal'>
<li>call install on each service</li>

<li>call start on each service</li>

<li>put main thread to sleep.</li>
</ol>
</dd>
<dt id='updateField' class='method hidden'>updateField<a href='AbstractMain_src.html#updateField'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>private <a href='../sys/Void.html'>Void</a> updateField(<a href='../sys/Field.html'>Field</a> f, <a href='../sys/Str.html'>Str</a> tok)</code></p>
</dd>
<dt id='usage' class='method'>usage<a href='AbstractMain_src.html#usage'>Source</a></dt>
<dd>
<p><code class='sig'>virtual <a href='../sys/Int.html'>Int</a> usage(<a href='../sys/OutStream.html'>OutStream</a> out := Env.cur().out())</code></p>

<p>Print usage of arguments and options. Return non-zero.</p>
</dd>
<dt id='usageArg' class='method hidden'>usageArg<a href='AbstractMain_src.html#usageArg'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>private <a href='../sys/Str.html'>Str</a>[] usageArg(<a href='../sys/Field.html'>Field</a> field)</code></p>
</dd>
<dt id='usageOpt' class='method hidden'>usageOpt<a href='AbstractMain_src.html#usageOpt'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>private <a href='../sys/Str.html'>Str</a>[] usageOpt(<a href='../sys/Field.html'>Field</a> field)</code></p>
</dd>
<dt id='usagePad' class='method hidden'>usagePad<a href='AbstractMain_src.html#usagePad'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>private <a href='../sys/Str.html'>Str</a>[][] usagePad(<a href='../sys/Str.html'>Str</a>[][] rows)</code></p>
</dd>
<dt id='usagePrint' class='method hidden'>usagePrint<a href='AbstractMain_src.html#usagePrint'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>private <a href='../sys/Void.html'>Void</a> usagePrint(<a href='../sys/OutStream.html'>OutStream</a> out, <a href='../sys/Str.html'>Str</a> title, <a href='../sys/Str.html'>Str</a>[][] rows)</code></p>
</dd>
</dl>
</div>
</div>
</div>
<div class='sidebar'>
<h2>Type</h2>
<ul class='clean'>
  <li><a href='AbstractMain_src.html'>View Source</a></li>
  <li><a href='#' onclick='ShowSlots.toggle(event); return false;'>Show All Slots</a></li>
</ul>
<div class='slots'>
<div class='overview'>
<h2>Slots</h2>
<ul class='clean'>
  <li><a href='#appName'>appName</a></li>
  <li><a href='#argFields'>argFields</a></li>
  <li class='hidden'><a href='#argName'>argName</a></li>
  <li><a href='#helpOpt'>helpOpt</a></li>
  <li><a href='#homeDir'>homeDir</a></li>
  <li><a href='#log'>log</a></li>
  <li><a href='#main'>main</a></li>
  <li><a href='#optFields'>optFields</a></li>
  <li class='hidden'><a href='#optName'>optName</a></li>
  <li class='hidden'><a href='#parseArg'>parseArg</a></li>
  <li><a href='#parseArgs'>parseArgs</a></li>
  <li class='hidden'><a href='#parseOpt'>parseOpt</a></li>
  <li class='hidden'><a href='#parseVal'>parseVal</a></li>
  <li><a href='#run'>run</a></li>
  <li><a href='#runServices'>runServices</a></li>
  <li class='hidden'><a href='#updateField'>updateField</a></li>
  <li><a href='#usage'>usage</a></li>
  <li class='hidden'><a href='#usageArg'>usageArg</a></li>
  <li class='hidden'><a href='#usageOpt'>usageOpt</a></li>
  <li class='hidden'><a href='#usagePad'>usagePad</a></li>
  <li class='hidden'><a href='#usagePrint'>usagePrint</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class='footer'>
<div>
<p>
util 1.0.56
[11-Nov-2010 Thu 10:08:19AM EST]
</p>
</div>
</div>
</body>
</html>
