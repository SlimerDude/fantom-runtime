<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
  <title>gfx::Font</title>
  <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
  <link rel='stylesheet' type='text/css' href='../doc.css'/>
  <script type='text/javascript' src='../doc.js'></script>
<!--[if lt IE 7]>
<script src='http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js' type='text/javascript'></script>
<![endif]-->
</head>
<body onload='Login.check();'>
<div class='header'>
<div>
<h1><a href='/'>Fantom</a></h1>
<p id='sidewalkLogin_'>&nbsp;</p>
<form method='get' action='/sidewalk/search/'>
<p>
<input type='text' name='q' size='30' value='Search...' onfocus='if (value=="Search...") value=""' onblur='if (value=="") value="Search..."' />
</p>
</form>
<ul>
<li><a href='/'>Home</a></li>
<li class='active'><a href='../index.html'>Docs</a></li>
<li><a href='/sidewalk/blog/'>Blog</a></li>
<li><a href='/sidewalk/ticket/'>Tickets</a></li>
<li><a href='/sidewalk/topic/'>Discuss</a></li>
</ul></div>
</div>
<div class='subHeader'>
<div>
<ul>
  <li><a href='../index.html'>Doc Home</a></li>
  <li>&gt;</li>
  <li><a href='index.html'>gfx</a></li>
  <li>&gt;</li>
  <li><a href='Font.html'>Font</a></li>
</ul>
</div>
</div>
<div class='content'>
<div>
<div class='fandoc'>
<div class='type'>
<div class='overview'>
<h2>const class</h2>
<h1>gfx::Font</h1>
<pre><a href='../sys/Obj.html'>sys::Obj</a>
  gfx::Font</pre>
</div>
</div>
<div class='src'>
<pre>
<span class='y'>//</span>
<span class='y'>// Copyright (c) 2008, Brian Frank and Andy Frank</span>
<span class='y'>// Licensed under the Academic Free License version 3.0</span>
<span class='y'>//</span>
<span class='y'>// History:</span>
<span class='y'>//   16 Jun 08  Brian Frank  Creation</span>
<span class='y'>//</span>

<span class='z'>**</span>
<span class='z'>** Font models the rendering of text.</span>
<span class='z'>**</span>
@Js
@Serializable <span class='b'>{</span> simple = <span class='k'>true</span> <span class='b'>}</span>
<span class='k'>const</span> <span class='k'>class</span> Font
<span class='b'>{</span>

<span class='y'>//////////////////////////////////////////////////////////////////////////</span>
<span class='y'>// Construction</span>
<span class='y'>//////////////////////////////////////////////////////////////////////////</span>

  <span class='z'>**</span>
  <span class='z'>** Construct with it-block</span>
  <span class='z'>**</span>
  <span class='k'>new</span> <span id='make'>make</span><span class='b'>(</span>|This| f<span class='b'>)</span>
  <span class='b'>{</span>
    f<span class='b'>(</span><span class='k'>this</span><span class='b'>)</span>
  <span class='b'>}</span>

  <span class='z'>**</span>
  <span class='z'>** Construct a Font with family name, size in points, and optional</span>
  <span class='z'>** bold/italic style.  This is internal for now, because eventually</span>
  <span class='z'>** we should be able to collapse this and it-block into single ctor.</span>
  <span class='z'>**</span>
  @NoDoc <span class='k'>new</span> <span id='makeFields'>makeFields</span><span class='b'>(</span>Str name, Int size := 12, Bool bold := <span class='k'>false</span>, Bool italic := <span class='k'>false</span><span class='b'>)</span>
  <span class='b'>{</span>
    <span class='k'>this</span>.name = name
    <span class='k'>this</span>.size   = size
    <span class='k'>this</span>.bold   = bold
    <span class='k'>this</span>.italic = italic
  <span class='b'>}</span>

  <span class='z'>**</span>
  <span class='z'>** Parse font from string (see `toStr`).  If invalid</span>
  <span class='z'>** and checked is true then throw ParseErr otherwise</span>
  <span class='z'>** return null.</span>
  <span class='z'>**</span>
  <span class='z'>** Examples:</span>
  <span class='z'>**   Font.fromStr("12pt Arial")</span>
  <span class='z'>**   Font.fromStr("bold 10pt Courier")</span>
  <span class='z'>**   Font.fromStr("bold italic 8pt Times Roman")</span>
  <span class='z'>**</span>
  <span class='k'>static</span> Font? <span id='fromStr'>fromStr</span><span class='b'>(</span>Str s, Bool checked := <span class='k'>true</span><span class='b'>)</span>
  <span class='b'>{</span>
    <span class='k'>try</span>
    <span class='b'>{</span>
      Str? name := <span class='k'>null</span>
      Int? size := <span class='k'>null</span>
      bold   := <span class='k'>false</span>
      italic := <span class='k'>false</span>

      toks := s.split
      <span class='k'>for</span> <span class='b'>(</span>i:=0; i&lt;toks.size; ++i<span class='b'>)</span>
      <span class='b'>{</span>
        tok := toks<span class='b'>[</span>i<span class='b'>]</span>
        <span class='k'>if</span> <span class='b'>(</span>tok == <span class='s'>"bold"</span><span class='b'>)</span> bold = <span class='k'>true</span>;
        <span class='k'>else</span> <span class='k'>if</span> <span class='b'>(</span>tok == <span class='s'>"italic"</span><span class='b'>)</span> italic = <span class='k'>true</span>
        <span class='k'>else</span> <span class='k'>if</span> <span class='b'>(</span>size != <span class='k'>null</span><span class='b'>)</span> name = name == <span class='k'>null</span> ? tok : <span class='s'>"$name $tok"</span>
        <span class='k'>else</span> <span class='k'>if</span> <span class='b'>(</span>!tok.endsWith<span class='b'>(</span><span class='s'>"pt"</span><span class='b'>))</span> <span class='k'>throw</span> Err<span class='b'>()</span>
        <span class='k'>else</span> size = tok<span class='b'>[</span>0..-3<span class='b'>]</span>.toInt
      <span class='b'>}</span>

      <span class='k'>return</span> makeFields<span class='b'>(</span>name, size.toInt, bold, italic<span class='b'>)</span>
    <span class='b'>}</span>
    <span class='k'>catch</span> <span class='b'>{}</span>
    <span class='k'>if</span> <span class='b'>(</span>checked<span class='b'>)</span> <span class='k'>throw</span> ParseErr<span class='b'>(</span><span class='s'>"Invalid Font: $s"</span><span class='b'>)</span>
    <span class='k'>return</span> <span class='k'>null</span>
  <span class='b'>}</span>

<span class='y'>//////////////////////////////////////////////////////////////////////////</span>
<span class='y'>// Font</span>
<span class='y'>//////////////////////////////////////////////////////////////////////////</span>

  <span class='z'>**</span>
  <span class='z'>** Name of font.</span>
  <span class='z'>**</span>
  <span class='k'>const</span> Str <span id='name'>name</span> := <span class='s'>"Serif"</span>

  <span class='z'>**</span>
  <span class='z'>** Size of font in points.</span>
  <span class='z'>**</span>
  <span class='k'>const</span> Int <span id='size'>size</span> := 11

  <span class='z'>**</span>
  <span class='z'>** Is this font bold.</span>
  <span class='z'>**</span>
  <span class='k'>const</span> Bool <span id='bold'>bold</span>

  <span class='z'>**</span>
  <span class='z'>** Is this font in italic.</span>
  <span class='z'>**</span>
  <span class='k'>const</span> Bool <span id='italic'>italic</span>

<span class='y'>//////////////////////////////////////////////////////////////////////////</span>
<span class='y'>// Identity</span>
<span class='y'>//////////////////////////////////////////////////////////////////////////</span>

  <span class='z'>**</span>
  <span class='z'>** Return hash of name, size, and style.</span>
  <span class='z'>**</span>
  <span class='k'>override</span> Int <span id='hash'>hash</span><span class='b'>()</span>
  <span class='b'>{</span>
    hash := name.hash.xor<span class='b'>(</span>size<span class='b'>)</span>
    <span class='k'>if</span> <span class='b'>(</span>bold<span class='b'>)</span> hash *= 73
    <span class='k'>if</span> <span class='b'>(</span>italic<span class='b'>)</span> hash *= 19
    <span class='k'>return</span> hash
  <span class='b'>}</span>

  <span class='z'>**</span>
  <span class='z'>** Equality is based on name, size, and style.</span>
  <span class='z'>**</span>
  <span class='k'>override</span> Bool <span id='equals'>equals</span><span class='b'>(</span>Obj? that<span class='b'>)</span>
  <span class='b'>{</span>
    x := that <span class='k'>as</span> Font
    <span class='k'>if</span> <span class='b'>(</span>x == <span class='k'>null</span><span class='b'>)</span> <span class='k'>return</span> <span class='k'>false</span>
    <span class='k'>return</span> name == x.name &amp;&amp;
           size == x.size &amp;&amp;
           bold == x.bold &amp;&amp;
           italic == x.italic
  <span class='b'>}</span>

  <span class='z'>**</span>
  <span class='z'>** Format as '"[bold] [italic] &lt;size&gt;pt &lt;name&gt;"'</span>
  <span class='z'>**</span>
  <span class='k'>override</span> Str <span id='toStr'>toStr</span><span class='b'>()</span>
  <span class='b'>{</span>
    s := StrBuf<span class='b'>()</span>
    <span class='k'>if</span> <span class='b'>(</span>bold<span class='b'>)</span> s.add<span class='b'>(</span><span class='s'>"bold"</span><span class='b'>)</span>
    <span class='k'>if</span> <span class='b'>(</span>italic<span class='b'>)</span>
    <span class='b'>{</span>
      <span class='k'>if</span> <span class='b'>(</span>!s.isEmpty<span class='b'>)</span> s.add<span class='b'>(</span><span class='s'>" "</span><span class='b'>)</span>
      s.add<span class='b'>(</span><span class='s'>"italic"</span><span class='b'>)</span>
    <span class='b'>}</span>
    <span class='k'>if</span> <span class='b'>(</span>!s.isEmpty<span class='b'>)</span> s.add<span class='b'>(</span><span class='s'>" "</span><span class='b'>)</span>
    s.add<span class='b'>(</span>size<span class='b'>)</span>.add<span class='b'>(</span><span class='s'>"pt "</span><span class='b'>)</span>.add<span class='b'>(</span>name<span class='b'>)</span>
    <span class='k'>return</span> s.toStr
  <span class='b'>}</span>

<span class='y'>//////////////////////////////////////////////////////////////////////////</span>
<span class='y'>// Utils</span>
<span class='y'>//////////////////////////////////////////////////////////////////////////</span>

  <span class='z'>**</span>
  <span class='z'>** Return this font, but with the specified point size.</span>
  <span class='z'>** If thsi font already has the given size return this.</span>
  <span class='z'>**</span>
  Font <span id='toSize'>toSize</span><span class='b'>(</span>Int size<span class='b'>)</span>
  <span class='b'>{</span>
    <span class='k'>if</span> <span class='b'>(</span><span class='k'>this</span>.size == size<span class='b'>)</span> <span class='k'>return</span> <span class='k'>this</span>
    <span class='k'>return</span> Font.makeFields<span class='b'>(</span>name, size, bold, italic<span class='b'>)</span>
  <span class='b'>}</span>

  <span class='z'>**</span>
  <span class='z'>** Return this font, but with a plain styling (neither</span>
  <span class='z'>** bold, nor italic).  If this font is already plain</span>
  <span class='z'>** then return this.</span>
  <span class='z'>**</span>
  Font <span id='toPlain'>toPlain</span><span class='b'>()</span>
  <span class='b'>{</span>
    <span class='k'>if</span> <span class='b'>(</span>!bold &amp;&amp; !italic<span class='b'>)</span> <span class='k'>return</span> <span class='k'>this</span>
    <span class='k'>return</span> Font.makeFields<span class='b'>(</span>name, size, <span class='k'>false</span>, <span class='k'>false</span><span class='b'>)</span>
  <span class='b'>}</span>

  <span class='z'>**</span>
  <span class='z'>** Return this font, but with a bold styling.  If</span>
  <span class='z'>** this font is already bold then return this.</span>
  <span class='z'>**</span>
  Font <span id='toBold'>toBold</span><span class='b'>()</span>
  <span class='b'>{</span>
    <span class='k'>if</span> <span class='b'>(</span>bold<span class='b'>)</span> <span class='k'>return</span> <span class='k'>this</span>
    <span class='k'>return</span> Font.makeFields<span class='b'>(</span>name, size, <span class='k'>true</span>, italic<span class='b'>)</span>
  <span class='b'>}</span>

  <span class='z'>**</span>
  <span class='z'>** Return this font, but with a italic styling.  If</span>
  <span class='z'>** this font is already italic then return this.</span>
  <span class='z'>**</span>
  Font <span id='toItalic'>toItalic</span><span class='b'>()</span>
  <span class='b'>{</span>
    <span class='k'>if</span> <span class='b'>(</span>italic<span class='b'>)</span> <span class='k'>return</span> <span class='k'>this</span>
    <span class='k'>return</span> Font.makeFields<span class='b'>(</span>name, size, bold, <span class='k'>true</span><span class='b'>)</span>
  <span class='b'>}</span>

<span class='y'>//////////////////////////////////////////////////////////////////////////</span>
<span class='y'>// Metrics</span>
<span class='y'>//////////////////////////////////////////////////////////////////////////</span>

  <span class='z'>**</span>
  <span class='z'>** Get height of this font for `GfxEnv.cur`.  The height</span>
  <span class='z'>** is the pixels is the sum of ascent, descent, and leading.</span>
  <span class='z'>**</span>
  Int <span id='height'>height</span><span class='b'>()</span> <span class='b'>{</span> GfxEnv.cur.fontHeight<span class='b'>(</span><span class='k'>this</span><span class='b'>)</span> <span class='b'>}</span>

  <span class='z'>**</span>
  <span class='z'>** Get ascent of this font on `GfxEnv.cur`.  The ascent</span>
  <span class='z'>** is the distance in pixels from baseline to top of chars, not</span>
  <span class='z'>** including any leading area.</span>
  <span class='z'>**</span>
  Int <span id='ascent'>ascent</span><span class='b'>()</span> <span class='b'>{</span> GfxEnv.cur.fontAscent<span class='b'>(</span><span class='k'>this</span><span class='b'>)</span> <span class='b'>}</span>

  <span class='z'>**</span>
  <span class='z'>** Get descent of this font on `GfxEnv.cur`.  The descent</span>
  <span class='z'>** is the distance in pixels from baseline to bottom of chars, not</span>
  <span class='z'>** including any leading area.</span>
  <span class='z'>**</span>
  Int <span id='descent'>descent</span><span class='b'>()</span> <span class='b'>{</span> GfxEnv.cur.fontDescent<span class='b'>(</span><span class='k'>this</span><span class='b'>)</span> <span class='b'>}</span>

  <span class='z'>**</span>
  <span class='z'>** Get leading of this font on `GfxEnv.cur`.  The leading</span>
  <span class='z'>** area is the distance in pixels above the ascent which may include</span>
  <span class='z'>** accents and other marks.</span>
  <span class='z'>**</span>
  Int <span id='leading'>leading</span><span class='b'>()</span> <span class='b'>{</span> GfxEnv.cur.fontLeading<span class='b'>(</span><span class='k'>this</span><span class='b'>)</span> <span class='b'>}</span>

  <span class='z'>**</span>
  <span class='z'>** Get the width of the string in pixels when painted</span>
  <span class='z'>** with this font on `GfxEnv.cur`.</span>
  <span class='z'>**</span>
  Int <span id='width'>width</span><span class='b'>(</span>Str s<span class='b'>)</span> <span class='b'>{</span> GfxEnv.cur.fontWidth<span class='b'>(</span><span class='k'>this</span>, s<span class='b'>)</span> <span class='b'>}</span>


<span class='b'>}</span></pre>
</div>
</div>
<div class='sidebar'>
<h2>More Info</h2>
<ul class='clean'>
  <li><a href='Font.html'>View Fandoc</a></li>
</ul>
<div class='slots'>
<div class='overview'>
<h2>Slots</h2>
<ul class='clean'>
  <li style='display: block;'><a href='#ascent'>ascent</a></li>
  <li style='display: block;'><a href='#bold'>bold</a></li>
  <li style='display: block;'><a href='#descent'>descent</a></li>
  <li style='display: block;'><a href='#equals'>equals</a></li>
  <li style='display: block;'><a href='#fromStr'>fromStr</a></li>
  <li style='display: block;'><a href='#hash'>hash</a></li>
  <li style='display: block;'><a href='#height'>height</a></li>
  <li style='display: block;'><a href='#italic'>italic</a></li>
  <li style='display: block;'><a href='#leading'>leading</a></li>
  <li style='display: block;'><a href='#make'>make</a></li>
  <li style='display: block;'><a href='#name'>name</a></li>
  <li style='display: block;'><a href='#size'>size</a></li>
  <li style='display: block;'><a href='#toBold'>toBold</a></li>
  <li style='display: block;'><a href='#toItalic'>toItalic</a></li>
  <li style='display: block;'><a href='#toPlain'>toPlain</a></li>
  <li style='display: block;'><a href='#toSize'>toSize</a></li>
  <li style='display: block;'><a href='#toStr'>toStr</a></li>
  <li style='display: block;'><a href='#width'>width</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class='footer'>
<div>
<p>
gfx 1.0.56
[11-Nov-2010 Thu 10:08:24AM EST]
</p>
</div>
</div>
</body>
</html>
