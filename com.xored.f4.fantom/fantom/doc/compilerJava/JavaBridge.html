<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
  <title>compilerJava::JavaBridge</title>
  <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
  <link rel='stylesheet' type='text/css' href='../doc.css'/>
  <script type='text/javascript' src='../doc.js'></script>
<!--[if lt IE 7]>
<script src='http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js' type='text/javascript'></script>
<![endif]-->
</head>
<body onload='Login.check();'>
<div class='header'>
<div>
<h1><a href='/'>Fantom</a></h1>
<p id='sidewalkLogin_'>&nbsp;</p>
<form method='get' action='/sidewalk/search/'>
<p>
<input type='text' name='q' size='30' value='Search...' onfocus='if (value=="Search...") value=""' onblur='if (value=="") value="Search..."' />
</p>
</form>
<ul>
<li><a href='/'>Home</a></li>
<li class='active'><a href='../index.html'>Docs</a></li>
<li><a href='/sidewalk/blog/'>Blog</a></li>
<li><a href='/sidewalk/ticket/'>Tickets</a></li>
<li><a href='/sidewalk/topic/'>Discuss</a></li>
</ul></div>
</div>
<div class='subHeader'>
<div>
<ul>
  <li><a href='../index.html'>Doc Home</a></li>
  <li>&gt;</li>
  <li><a href='index.html'>compilerJava</a></li>
  <li>&gt;</li>
  <li><a href='JavaBridge.html'>JavaBridge</a></li>
</ul>
</div>
</div>
<div class='content'>
<div>
<div class='fandoc'>
<div class='type'>
<div class='overview'>
<h2>class</h2>
<h1>compilerJava::JavaBridge</h1>
<pre><a href='../sys/Obj.html'>sys::Obj</a>
  <a href='../compiler/CompilerSupport.html'>compiler::CompilerSupport</a>
    <a href='../compiler/CBridge.html'>compiler::CBridge</a>
      compilerJava::JavaBridge</pre>
</div>
<div class='detail'>

<p>JavaBridge is the compiler plugin for bringing Java classes into the Fantom type system.</p>
</div>
</div>
<div class='slots'>
<div class='detail'>
<h2>Slots</h2>
<dl>
<dt id='areParamsSame' class='method'>areParamsSame<a href='JavaBridge_src.html#areParamsSame'>Source</a></dt>
<dd>
<p><code class='sig'>static <a href='../sys/Bool.html'>Bool</a> areParamsSame(<a href='../compiler/CMethod.html'>CMethod</a> a, <a href='../compiler/CMethod.html'>CMethod</a> b)</code></p>

<p>Do the two methods have the exact same parameter types.</p>
</dd>
<dt id='arrayToList' class='method hidden'>arrayToList<a href='JavaBridge_src.html#arrayToList'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>private <a href='../compiler/Expr.html'>Expr</a> arrayToList(<a href='../compiler/Expr.html'>Expr</a> expr, <a href='../compiler/CType.html'>CType</a> of)</code></p>

<p>Generate List.make(of, expr) where expr is Object[]</p>
</dd>
<dt id='boolTypes' class='field'>boolTypes<a href='JavaBridge_src.html#boolTypes'>Source</a></dt>
<dd>
<p><code class='sig'>const static <a href='../sys/Str.html'>Str</a>[] boolTypes := ...</code></p>
</dd>
<dt id='box' class='method hidden'>box<a href='JavaBridge_src.html#box'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>private <a href='../compiler/Expr.html'>Expr</a> box(<a href='../compiler/Expr.html'>Expr</a> expr)</code></p>

<p>Ensure value type is boxed.</p>
</dd>
<dt id='checkMethodOverride' class='method hidden'>checkMethodOverride<a href='JavaBridge_src.html#checkMethodOverride'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>private <a href='../sys/Void.html'>Void</a> checkMethodOverride(<a href='../compiler/TypeDef.html'>TypeDef</a> t, <a href='JavaMethod.html'>JavaMethod</a> base, <a href='../compiler/MethodDef.html'>MethodDef</a> def)</code></p>

<p>Called on method/method overrides in the checkOverride callback.</p>
</dd>
<dt id='checkOverride' class='method'>checkOverride<a href='JavaBridge_src.html#checkOverride'>Source</a></dt>
<dd>
<p><code class='sig'>override <a href='../sys/Void.html'>Void</a> checkOverride(<a href='../compiler/TypeDef.html'>TypeDef</a> t, <a href='../compiler/CSlot.html'>CSlot</a> base, <a href='../compiler/SlotDef.html'>SlotDef</a> def)</code></p>
<div class='slotInfo'>
<p>Overrides <a href='../compiler/CBridge.html#checkOverride'>compiler::CBridge.checkOverride</a></p>
</div>

<p>Called during Inherit step when a Fantom slot overrides a FFI slot. Log and throw compiler error if there is a problem.</p>
</dd>
<dt id='checkType' class='method'>checkType<a href='JavaBridge_src.html#checkType'>Source</a></dt>
<dd>
<p><code class='sig'>override <a href='../sys/Void.html'>Void</a> checkType(<a href='../compiler/TypeDef.html'>TypeDef</a> def)</code></p>
<div class='slotInfo'>
<p>Overrides <a href='../compiler/CBridge.html#checkType'>compiler::CBridge.checkType</a></p>
</div>

<p>Called during CheckErrors step for a type which extends a FFI class or implements any FFI mixins.</p>
</dd>
<dt id='classType' class='method'>classType<a href='JavaBridge_src.html#classType'>Source</a></dt>
<dd>
<p><code class='sig'><a href='JavaType.html'>JavaType</a> classType()</code></p>

<p>Get a CType representation for <code>java.lang.Class</code></p>
</dd>
<dt id='coerce' class='method'>coerce<a href='JavaBridge_src.html#coerce'>Source</a></dt>
<dd>
<p><code class='sig'>override <a href='../compiler/Expr.html'>Expr</a> coerce(<a href='../compiler/Expr.html'>Expr</a> expr, <a href='../compiler/CType.html'>CType</a> expected, |->| onErr)</code></p>
<div class='slotInfo'>
<p>Overrides <a href='../compiler/CBridge.html#coerce'>compiler::CBridge.coerce</a></p>
</div>

<p>Coerce expression to expected type.  If not a type match then run the onErr function.</p>
</dd>
<dt id='coerceFromArray' class='method'>coerceFromArray<a href='JavaBridge_src.html#coerceFromArray'>Source</a></dt>
<dd>
<p><code class='sig'><a href='../compiler/Expr.html'>Expr</a> coerceFromArray(<a href='../compiler/Expr.html'>Expr</a> expr, <a href='../compiler/CType.html'>CType</a> expected, |->| onErr)</code></p>

<p>Coerce a Java array to a Fantom list.</p>
</dd>
<dt id='coerceFromPrimitive' class='method'>coerceFromPrimitive<a href='JavaBridge_src.html#coerceFromPrimitive'>Source</a></dt>
<dd>
<p><code class='sig'><a href='../compiler/Expr.html'>Expr</a> coerceFromPrimitive(<a href='../compiler/Expr.html'>Expr</a> expr, <a href='../compiler/CType.html'>CType</a> expected, |->| onErr)</code></p>

<p>Coerce a Java primitive to a Fantom type.</p>
</dd>
<dt id='coerceFuncToInterface' class='method'>coerceFuncToInterface<a href='JavaBridge_src.html#coerceFuncToInterface'>Source</a></dt>
<dd>
<p><code class='sig'><a href='../compiler/Expr.html'>Expr</a> coerceFuncToInterface(<a href='../compiler/Expr.html'>Expr</a> expr, <a href='JavaType.html'>JavaType</a> expected, |->| onErr)</code></p>

<p>Attempt to coerce a parameterized sys::Func expr to a Java interface if the interface supports exactly one matching method.</p>
</dd>
<dt id='coerceToArray' class='method'>coerceToArray<a href='JavaBridge_src.html#coerceToArray'>Source</a></dt>
<dd>
<p><code class='sig'><a href='../compiler/Expr.html'>Expr</a> coerceToArray(<a href='../compiler/Expr.html'>Expr</a> expr, <a href='../compiler/CType.html'>CType</a> expected, |->| onErr)</code></p>

<p>Coerce a Fantom list to Java array.</p>
</dd>
<dt id='coerceToPrimitive' class='method'>coerceToPrimitive<a href='JavaBridge_src.html#coerceToPrimitive'>Source</a></dt>
<dd>
<p><code class='sig'><a href='../compiler/Expr.html'>Expr</a> coerceToPrimitive(<a href='../compiler/Expr.html'>Expr</a> expr, <a href='JavaType.html'>JavaType</a> expected, |->| onErr)</code></p>

<p>Coerce a fan expression to a Java primitive (other than the ones we support natively)</p>
</dd>
<dt id='cp' class='field'>cp<a href='JavaBridge_src.html#cp'>Source</a></dt>
<dd>
<p><code class='sig'>readonly <a href='ClassPath.html'>ClassPath</a> cp</code></p>
</dd>
<dt id='decimalTypes' class='field'>decimalTypes<a href='JavaBridge_src.html#decimalTypes'>Source</a></dt>
<dd>
<p><code class='sig'>const static <a href='../sys/Str.html'>Str</a>[] decimalTypes := ...</code></p>
</dd>
<dt id='fits' class='method'>fits<a href='JavaBridge_src.html#fits'>Source</a></dt>
<dd>
<p><code class='sig'><a href='../sys/Bool.html'>Bool</a> fits(<a href='../compiler/CType.html'>CType</a> actual, <a href='../compiler/CType.html'>CType</a> expected)</code></p>

<p>Return if we can make the actual type fit the expected type, potentially using a coercion.</p>
</dd>
<dt id='floatTypes' class='field'>floatTypes<a href='JavaBridge_src.html#floatTypes'>Source</a></dt>
<dd>
<p><code class='sig'>const static <a href='../sys/Str.html'>Str</a>[] floatTypes := ...</code></p>
</dd>
<dt id='funcWrappers' class='field hidden'>funcWrappers<a href='JavaBridge_src.html#funcWrappers'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>private <a href='../sys/Str.html'>Str</a>:<a href='../compiler/CMethod.html'>CMethod</a> funcWrappers := [Str:CMethod][:]</code></p>
</dd>
<dt id='generateFuncToInterfaceWrapper' class='method'>generateFuncToInterfaceWrapper<a href='JavaBridge_src.html#generateFuncToInterfaceWrapper'>Source</a></dt>
<dd>
<p><code class='sig'><a href='../compiler/CMethod.html'>CMethod</a> generateFuncToInterfaceWrapper(<a href='../compiler/Loc.html'>Loc</a> loc, <a href='../compiler/FuncType.html'>FuncType</a> funcType, <a href='../compiler/CType.html'>CType</a> expected, <a href='../compiler/CMethod.html'>CMethod</a> method)</code></p>

<p>Generate the wrapper which implements the specified expected interface and overrides the specified method which calls the function.</p>
</dd>
<dt id='intTypes' class='field'>intTypes<a href='JavaBridge_src.html#intTypes'>Source</a></dt>
<dd>
<p><code class='sig'>const static <a href='../sys/Str.html'>Str</a>[] intTypes := ...</code></p>
</dd>
<dt id='isFuncToInterfaceMatch' class='method'>isFuncToInterfaceMatch<a href='JavaBridge_src.html#isFuncToInterfaceMatch'>Source</a></dt>
<dd>
<p><code class='sig'><a href='../sys/Bool.html'>Bool</a> isFuncToInterfaceMatch(<a href='../compiler/FuncType.html'>FuncType</a> funcType, <a href='../compiler/CMethod.html'>CMethod</a> method)</code></p>

<p>Return if the specified function type can be used to implement the specified interface method.</p>
</dd>
<dt id='isMoreSpecific' class='method hidden'>isMoreSpecific<a href='JavaBridge_src.html#isMoreSpecific'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>static internal <a href='../sys/Bool.html'>Bool</a> isMoreSpecific(<a href='CallMatch.html'>CallMatch</a> a, <a href='CallMatch.html'>CallMatch</a> b)</code></p>

<p>Is <code>a</code> more specific than <code>b</code> such that <code>a</code> could be used passed to <code>b</code> without a compile time error.</p>
</dd>
<dt id='isOverrideInferredType' class='method hidden'>isOverrideInferredType<a href='JavaBridge_src.html#isOverrideInferredType'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>static private <a href='../sys/Bool.html'>Bool</a> isOverrideInferredType(<a href='../compiler/CType.html'>CType</a> base, <a href='../compiler/CType.html'>CType</a> def)</code></p>

<p>When overriding a Java method check if the base type is is a Java primitive or array and the override definition is matches how the Java type is inferred in the Fantom type system. If we have a match return true and we'll swizzle things in checkMethodOverride.</p>
</dd>
<dt id='listAsArray' class='method'>listAsArray<a href='JavaBridge_src.html#listAsArray'>Source</a></dt>
<dd>
<p><code class='sig'><a href='../compiler/CMethod.html'>CMethod</a> listAsArray()</code></p>

<p>Get a CMethod representation for <code>Object[] List.asArray()</code></p>
</dd>
<dt id='listMakeFromArray' class='method'>listMakeFromArray<a href='JavaBridge_src.html#listMakeFromArray'>Source</a></dt>
<dd>
<p><code class='sig'><a href='../compiler/CMethod.html'>CMethod</a> listMakeFromArray()</code></p>

<p>Get a CMethod representation for <code>List.make(Type, Object[])</code></p>
</dd>
<dt id='loadType' class='method'>loadType<a href='JavaBridge_src.html#loadType'>Source</a></dt>
<dd>
<p><code class='sig'>virtual <a href='../sys/Void.html'>Void</a> loadType(<a href='JavaType.html'>JavaType</a> type, <a href='../sys/Str.html'>Str</a>:<a href='../compiler/CSlot.html'>CSlot</a> slots)</code></p>

<p>Map class meta-data and Java members to Fantom slots for the specified JavaType.</p>
</dd>
<dt id='make' class='method'>make<a href='JavaBridge_src.html#make'>Source</a></dt>
<dd>
<p><code class='sig'>new make(<a href='../compiler/Compiler.html'>Compiler</a> c, <a href='ClassPath.html'>ClassPath</a> cp := ClassPath.makeForCurrent())</code></p>

<p>Construct a JavaBridge for current environment</p>
</dd>
<dt id='matchCall' class='method hidden'>matchCall<a href='JavaBridge_src.html#matchCall'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>internal <a href='CallMatch.html'>CallMatch</a>? matchCall(<a href='../compiler/CallExpr.html'>CallExpr</a> call, <a href='../compiler/CMethod.html'>CMethod</a> m)</code></p>

<p>Check if the call matches the specified overload method. If so return method and coerced args otherwise return null.</p>
</dd>
<dt id='objectArrayType' class='method'>objectArrayType<a href='JavaBridge_src.html#objectArrayType'>Source</a></dt>
<dd>
<p><code class='sig'><a href='JavaType.html'>JavaType</a> objectArrayType()</code></p>

<p>Get a CType representation for <code>java.lang.Object[]</code></p>
</dd>
<dt id='primitives' class='field'>primitives<a href='JavaBridge_src.html#primitives'>Source</a></dt>
<dd>
<p><code class='sig'>readonly <a href='JavaPrimitives.html'>JavaPrimitives</a> primitives := JavaPrimitives(this)</code></p>
</dd>
<dt id='resolveCall' class='method'>resolveCall<a href='JavaBridge_src.html#resolveCall'>Source</a></dt>
<dd>
<p><code class='sig'>override <a href='../compiler/CallExpr.html'>CallExpr</a> resolveCall(<a href='../compiler/CallExpr.html'>CallExpr</a> call)</code></p>
<div class='slotInfo'>
<p>Overrides <a href='../compiler/CBridge.html#resolveCall'>compiler::CBridge.resolveCall</a></p>
</div>

<p>Resolve a method call: try to find the best match and apply any coercions needed.</p>
</dd>
<dt id='resolveConstruction' class='method'>resolveConstruction<a href='JavaBridge_src.html#resolveConstruction'>Source</a></dt>
<dd>
<p><code class='sig'>override <a href='../compiler/Expr.html'>Expr</a> resolveConstruction(<a href='../compiler/CallExpr.html'>CallExpr</a> call)</code></p>
<div class='slotInfo'>
<p>Overrides <a href='../compiler/CBridge.html#resolveConstruction'>compiler::CBridge.resolveConstruction</a></p>
</div>

<p>Resolve a construction call to a Java constructor.</p>
</dd>
<dt id='resolveConstructorChain' class='method'>resolveConstructorChain<a href='JavaBridge_src.html#resolveConstructorChain'>Source</a></dt>
<dd>
<p><code class='sig'>override <a href='../compiler/Expr.html'>Expr</a> resolveConstructorChain(<a href='../compiler/CallExpr.html'>CallExpr</a> call)</code></p>
<div class='slotInfo'>
<p>Overrides <a href='../compiler/CBridge.html#resolveConstructorChain'>compiler::CBridge.resolveConstructorChain</a></p>
</div>

<p>Resolve a construction chain call where a Fantom constructor calls the super-class constructor.  Type check the arguments and insert any conversions needed.</p>
</dd>
<dt id='resolveMostSpecific' class='method hidden'>resolveMostSpecific<a href='JavaBridge_src.html#resolveMostSpecific'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>static internal <a href='CallMatch.html'>CallMatch</a>? resolveMostSpecific(<a href='CallMatch.html'>CallMatch</a>[] matches)</code></p>

<p>Given a list of overloaed methods find the most specific method according to Java Language Specification 15.11.2.2.  The "informal intuition" rule is that a method is more specific than another if the first could be could be passed onto the second one.</p>
</dd>
<dt id='resolvePod' class='method'>resolvePod<a href='JavaBridge_src.html#resolvePod'>Source</a></dt>
<dd>
<p><code class='sig'>override <a href='../compiler/CPod.html'>CPod</a> resolvePod(<a href='../sys/Str.html'>Str</a> name, <a href='../compiler/Loc.html'>Loc</a>? loc)</code></p>
<div class='slotInfo'>
<p>Overrides <a href='../compiler/CBridge.html#resolvePod'>compiler::CBridge.resolvePod</a></p>
</div>

<p>Map a FFI "podName" to a Java package.</p>
</dd>
<dt id='resolveSlotAccess' class='method'>resolveSlotAccess<a href='JavaBridge_src.html#resolveSlotAccess'>Source</a></dt>
<dd>
<p><code class='sig'>override <a href='../compiler/CSlot.html'>CSlot</a>? resolveSlotAccess(<a href='../compiler/CType.html'>CType</a> base, <a href='../sys/Str.html'>Str</a> name, <a href='../sys/Bool.html'>Bool</a> noParens)</code></p>
<div class='slotInfo'>
<p>Overrides <a href='../compiler/CBridge.html#resolveSlotAccess'>compiler::CBridge.resolveSlotAccess</a></p>
</div>

<p>Given a dot operator slot access on the given foreign base type, determine the appopriate slot to use based on whether parens were used</p>

<pre>base.name    =>  noParens = true
base.name()  =>  noParens = false</pre>

<p>In Java a given name could be bound to both a field and a method.  In this case we only resolve the field if no parens are used.  We also handle the special case of Java annotations here because their element methods are also mapped as Fantom fields (instance based mixin field).</p>
</dd>
<dt id='strTypes' class='field'>strTypes<a href='JavaBridge_src.html#strTypes'>Source</a></dt>
<dd>
<p><code class='sig'>const static <a href='../sys/Str.html'>Str</a>[] strTypes := ...</code></p>
</dd>
</dl>
</div>
</div>
</div>
<div class='sidebar'>
<h2>Type</h2>
<ul class='clean'>
  <li><a href='JavaBridge_src.html'>View Source</a></li>
  <li><a href='#' onclick='ShowSlots.toggle(event); return false;'>Show All Slots</a></li>
</ul>
<div class='slots'>
<div class='overview'>
<h2>Slots</h2>
<ul class='clean'>
  <li><a href='#areParamsSame'>areParamsSame</a></li>
  <li class='hidden'><a href='#arrayToList'>arrayToList</a></li>
  <li><a href='#boolTypes'>boolTypes</a></li>
  <li class='hidden'><a href='#box'>box</a></li>
  <li class='hidden'><a href='#checkMethodOverride'>checkMethodOverride</a></li>
  <li><a href='#checkOverride'>checkOverride</a></li>
  <li><a href='#checkType'>checkType</a></li>
  <li><a href='#classType'>classType</a></li>
  <li><a href='#coerce'>coerce</a></li>
  <li><a href='#coerceFromArray'>coerceFromArray</a></li>
  <li><a href='#coerceFromPrimitive'>coerceFromPrimitive</a></li>
  <li><a href='#coerceFuncToInterface'>coerceFuncToInterface</a></li>
  <li><a href='#coerceToArray'>coerceToArray</a></li>
  <li><a href='#coerceToPrimitive'>coerceToPrimitive</a></li>
  <li><a href='#cp'>cp</a></li>
  <li><a href='#decimalTypes'>decimalTypes</a></li>
  <li><a href='#fits'>fits</a></li>
  <li><a href='#floatTypes'>floatTypes</a></li>
  <li class='hidden'><a href='#funcWrappers'>funcWrappers</a></li>
  <li><a href='#generateFuncToInterfaceWrapper'>generateFuncToInterfaceWrapper</a></li>
  <li><a href='#intTypes'>intTypes</a></li>
  <li><a href='#isFuncToInterfaceMatch'>isFuncToInterfaceMatch</a></li>
  <li class='hidden'><a href='#isMoreSpecific'>isMoreSpecific</a></li>
  <li class='hidden'><a href='#isOverrideInferredType'>isOverrideInferredType</a></li>
  <li><a href='#listAsArray'>listAsArray</a></li>
  <li><a href='#listMakeFromArray'>listMakeFromArray</a></li>
  <li><a href='#loadType'>loadType</a></li>
  <li><a href='#make'>make</a></li>
  <li class='hidden'><a href='#matchCall'>matchCall</a></li>
  <li><a href='#objectArrayType'>objectArrayType</a></li>
  <li><a href='#primitives'>primitives</a></li>
  <li><a href='#resolveCall'>resolveCall</a></li>
  <li><a href='#resolveConstruction'>resolveConstruction</a></li>
  <li><a href='#resolveConstructorChain'>resolveConstructorChain</a></li>
  <li class='hidden'><a href='#resolveMostSpecific'>resolveMostSpecific</a></li>
  <li><a href='#resolvePod'>resolvePod</a></li>
  <li><a href='#resolveSlotAccess'>resolveSlotAccess</a></li>
  <li><a href='#strTypes'>strTypes</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class='footer'>
<div>
<p>
compilerJava 1.0.56
[11-Nov-2010 Thu 10:08:17AM EST]
</p>
</div>
</div>
</body>
</html>
