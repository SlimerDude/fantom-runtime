<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
  <title>Flux</title>
  <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
  <link rel='stylesheet' type='text/css' href='../doc.css'/>
  <script type='text/javascript' src='../doc.js'></script>
<!--[if lt IE 7]>
<script src='http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js' type='text/javascript'></script>
<![endif]-->
</head>
<body onload='Login.check();'>
<div class='header'>
<div>
<h1><a href='/'>Fantom</a></h1>
<p id='sidewalkLogin_'>&nbsp;</p>
<form method='get' action='/sidewalk/search/'>
<p>
<input type='text' name='q' size='30' value='Search...' onfocus='if (value=="Search...") value=""' onblur='if (value=="") value="Search..."' />
</p>
</form>
<ul>
<li><a href='/'>Home</a></li>
<li class='active'><a href='../index.html'>Docs</a></li>
<li><a href='/sidewalk/blog/'>Blog</a></li>
<li><a href='/sidewalk/ticket/'>Tickets</a></li>
<li><a href='/sidewalk/topic/'>Discuss</a></li>
</ul></div>
</div>
<div class='subHeader'>
<div>
<ul>
  <li><a href='../index.html'>Doc Home</a></li>
  <li>&gt;</li>
  <li><a href='index.html'>docTools</a></li>
  <li>&gt;</li>
  <li><a href='Flux.html'>Flux</a></li>
</ul>
</div>
</div>
<div class='content'>
<div>
<div class='fandoc'>
<div class='prevNext'>
<div class='prev'><a href='Bootstrap.html'><img src='../go-previous.png' alt='prev' /></a> <a href='Bootstrap.html'>Bootstrap</a></div>
<div class='next'><a href='IDEs.html'>IDEs</a> <a href='IDEs.html'><img src='../go-next.png' alt='next' /></a></div>
</div>
<h1 class='title'>Flux</h1>

<h1 id='overview'>Overview </h1>

<p>The Fantom distribution includes a desktop tool called <em>flux</em>.  Flux is a framework for building general purpose desktop applications with the <a href='../fwt/pod-doc.html'>fwt</a> toolkit.  The standard Fantom distribution includes with a set of flux plugins which provide basic IDE support for Fantom.</p>

<p>On Window's you launch flux with the "flux.exe" executable.  On Unix use the "flux" bash script.  Both of these are just conveniences for running "fan flux::Main".  You can pass an optional filename to open on startup:</p>

<pre>flux
flux Foo.fan</pre>

<p>The Fantom installation used to run flux defines the set of plugins available.  By convention the flux plugins included in the standard distribution are prefixed with "flux".  You can add new plugins by dropping new pods into your "lib/fan" directory.</p>

<h1 id='navModel'>Navigation Model </h1>

<p>Flux is based on a browser based paradigm.  Users hyperlink from one Uri to another.  They can navigate back or forward in their navigation history just like a browser.</p>

<p>Unlike a normal browser, we leverage Fantom's built-in <a href='../docLang/Naming.html'>naming</a> framework.  This means we can use Flux to browser any Uri mapped into the Fantom's namespace including the file system, "fan:" namespaces, or any of the protocols plugged into Fantom via <code>UriScheme</code>.</p>

<p>When a user navigates to a uri, the uri is resolved into a Fantom object via the standard <a href='../docLang/Naming.html'>naming</a> subsystem.  We call the resolved object a <em>resource</em>.  Then the runtime uses <a href='../docLang/Env.html#index'>indexed props</a> to find all the <em>views</em> registered to view and edit the resource.  It is not uncommon for a resource to have multiple views, in which case the user can switch between them using the pull down on the right side of the locator bar.</p>

<p>See <a href='../flux/pod-doc.html'>flux::pod-doc</a> for the details regarding the navigation and the various APIs and framework hooks.</p>

<h1 id='textEditor'>Text Editor </h1>

<p>The <a href='../fluxText/index.html'>fluxText</a> pod provides a text editor plugin for working with files mapped to a "text/*" MIME type.  The flux editor is pretty basic if you are used to working with a monster like Eclipse. But you'll find quite a number of useful features:</p>

<ul>
<li><a href='#syntaxOptions'>syntax</a> color coding</li>

<li>auto indent</li>

<li>block indent and unindent</li>

<li>brace matching</li>

<li>various <a href='#textEditorOptions'>options</a> for whitespace handling</li>

<li>find and replace</li>
</ul>

<h1 id='options'>Options </h1>

<p>Flux options are stored in plain text fog files under "etc/flux" and "etc/fluxText".  In most cases editing the text file will be reloaded the next time a view is loaded.</p>

<h2 id='keyOptions'>Key Bindings </h2>

<p>All the commands in flux have a globally unique string id.  Common predefined commands have an id like "cut" or "save".  By default commands are configured as <code><a href='../fwt/Command.html#makeLocale'>localized props</a></code>.  But you can custom the key binding for any command via <code><a href='../flux/KeyOptions.html'>KeyOptions</a></code>.</p>

<h2 id='textEditorOptions'>Text Editor </h2>

<p>See the <code><a href='../fluxText/TextEditorOptions.html'>TextEditorOptions</a></code> to configure general options when working with text files:</p>

<ul>
<li>char encoding</li>

<li>Unix or Window's newline</li>

<li>convert tabs to spaces</li>

<li>tab spacing</li>

<li>strip trailing whitespace on save</li>
</ul>

<h2 id='syntaxOptions'>Syntax Color Coding </h2>

<p>You can add syntax color coding for new languages easily through the options.  First step is to map file extensions to a syntax definition via <code><a href='../fluxText/SyntaxOptions.html'>SyntaxOptions</a></code>.  You also use SytnaxOptions to configure your font and color preferences.</p>

<p>For example let's say we want to add support for "foolang".  First we edit "etc/fluxText/syntax.fog" to map the file extensions "foo" and "foolang" to the definition stored in "etc/fluxText/syntax/foolang.fog":</p>

<pre>extToRules =
[
  ...
  "foolang": "foolang",
  "foo": "foolang",
  ...</pre>

<p>Next we create the syntax rules in "etc/fluxText/syntax/foolang.fog" using <code><a href='../fluxText/SyntaxRules.html'>SyntaxRules</a></code>.  This is where we define our keywords and syntax for comments and string literals. It is easiest to start off with a definition for a language you are already familiar with.  For example Java's syntax rules are:</p>

<pre>// java syntax rules
SyntaxRules
{
  // list of end of line comment tokens
  comments = ["//"]

  // block comments
  blockCommentStart = "/*"
  blockCommentEnd   = "*/"
  blockCommentsNest = false

  // string and character literals
  strs =
  [
    SyntaxStr { delimiter = "\""; escape = '\\'; multiLine = false }, // String
    SyntaxStr { delimiter = "'"; escape = '\\'; multiLine = false }   // char
  ]

  // keyword list
  keywords =
  [
    "abstract",
    "assert",
    "boolean",
    ...</pre>

<h1 id='tools'>Tools </h1>

<p>You can add your own commands into the Tools menu.  Tools are nothing but a Fantom script file which declares a <code><a href='../flux/FluxCommand.html'>flux::FluxCommand</a></code> class.  The Tools menu structure reflects the "etc/flux/tools/" directory.  Sub-directories are represented as sub-menus and scripts ending in ".fan" are the command menu items.  When the command is executed the script is compiled if out of date and the <code>FluxCommand.invoke</code> is invoked.  Here is an example tool script:</p>

<pre>using fwt
using flux

class HelloWorld : FluxCommand
{
  new make(Str id) : super(id) {}

  override Void invoke(Event? event)
  {
    Dialog.openInfo(frame, "Hello world tool!")
  }
}</pre>

<p>A common use of tools is to spawn an external program such as a compiler. You can do this via the console sidebar.  For example assuming "fan" is your path, the following will run "fan -version" and show the output in the console:</p>

<pre>override Void invoke(Event? event)
{
  frame.console.show.exec(["fan", "-version"])
}</pre>

<p>The console will detect any absolute paths in the process output and turn them into "marks" which you can use to jump to with the JumpNext and JumpPrev commands.  You can also also click on any line in the console with a blue underline to jump to that file location.</p>

<p>If you wish to have an accelerator to your tool, then add the command to your "etc/flux/keys.fog" file, where the key is "tools.{filename}":</p>

<pre>bindings =
[
  "tools.HelloWorld": "Ctrl+F9",
  ...</pre>

<h1 id='compilingFan'>Compiling Fantom  </h1>

<p>The standard Fantom distribution includes a tools script called "Build". If you run this tool in any file which is under a directory which contains a "build.fan" script, it will run the build script with the default target - this a convenient way to recompile the current pod you are working on.</p>

<p>By default the fan installation used to run the build script is found by looking up the directory tree if your source tree is under fan home.  If your source is not under a fan installation, then the installation being used to run Flux is used to run the build script.</p>

<p>The compiler output is sent to the console.  Errors locations are marked with blue underlines in the console.  You can click the console to jump to that location, or use the JumpNext/JumpPrev commands to cycle thru the errors.</p>

<p>Remember that "Build" is just a tool script in the "etc/flux/tools" directory. You can change the script, or use it as a template to define new scripts.</p>

<h1 id='dev'>Developing for Flux </h1>

<p>Flux is itself a framework designed to be customized and extended with its plugin architecture.  See the <a href='../flux/pod-doc.html'>flux::pod-doc</a> to learn how to use the <code>flux</code> APIs for creating your own plugins.</p>
<div class='prevNext'>
<div class='prev'><a href='Bootstrap.html'><img src='../go-previous.png' alt='prev' /></a> <a href='Bootstrap.html'>Bootstrap</a></div>
<div class='next'><a href='IDEs.html'>IDEs</a> <a href='IDEs.html'><img src='../go-next.png' alt='next' /></a></div>
</div>
</div>
<div class='sidebar'>
<h2>Contents</h2>
<ul>
<li><a href='#overview'>Overview </a></li><li><a href='#navModel'>Navigation Model </a></li><li><a href='#textEditor'>Text Editor </a></li><li><a href='#options'>Options </a><ul>
<li><a href='#keyOptions'>Key Bindings </a></li><li><a href='#textEditorOptions'>Text Editor </a></li><li><a href='#syntaxOptions'>Syntax Color Coding </a></li></ul>
</li><li><a href='#tools'>Tools </a></li><li><a href='#compilingFan'>Compiling Fantom  </a></li><li><a href='#dev'>Developing for Flux </a></li></ul>
</div>
</div>
</div>
<div class='footer'>
<div>
<p>
docTools 1.0.56
[11-Nov-2010 Thu 10:08:29AM EST]
</p>
</div>
</div>
</body>
</html>
