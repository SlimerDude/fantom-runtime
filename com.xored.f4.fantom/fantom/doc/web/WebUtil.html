<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
  <title>web::WebUtil</title>
  <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
  <link rel='stylesheet' type='text/css' href='../doc.css'/>
  <script type='text/javascript' src='../doc.js'></script>
<!--[if lt IE 7]>
<script src='http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js' type='text/javascript'></script>
<![endif]-->
</head>
<body onload='Login.check();'>
<div class='header'>
<div>
<h1><a href='/'>Fantom</a></h1>
<p id='sidewalkLogin_'>&nbsp;</p>
<form method='get' action='/sidewalk/search/'>
<p>
<input type='text' name='q' size='30' value='Search...' onfocus='if (value=="Search...") value=""' onblur='if (value=="") value="Search..."' />
</p>
</form>
<ul>
<li><a href='/'>Home</a></li>
<li class='active'><a href='../index.html'>Docs</a></li>
<li><a href='/sidewalk/blog/'>Blog</a></li>
<li><a href='/sidewalk/ticket/'>Tickets</a></li>
<li><a href='/sidewalk/topic/'>Discuss</a></li>
</ul></div>
</div>
<div class='subHeader'>
<div>
<ul>
  <li><a href='../index.html'>Doc Home</a></li>
  <li>&gt;</li>
  <li><a href='index.html'>web</a></li>
  <li>&gt;</li>
  <li><a href='WebUtil.html'>WebUtil</a></li>
</ul>
</div>
</div>
<div class='content'>
<div>
<div class='fandoc'>
<div class='type'>
<div class='overview'>
<h2>class</h2>
<h1>web::WebUtil</h1>
<pre><a href='../sys/Obj.html'>sys::Obj</a>
  web::WebUtil</pre>
</div>
<p><code class='sig'>@<a href='../sys/Js.html'>Js</a> <br/>
</code></p>
<div class='detail'>

<p>WebUtil encapsulates several useful utility web methods. Also see <code><a href='../sys/MimeType.html'>sys::MimeType</a></code> and its utility methods.</p>
</div>
</div>
<div class='slots'>
<div class='detail'>
<h2>Slots</h2>
<dl>
<dt id='CR' class='field hidden'>CR<a href='WebUtil_src.html#CR'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>const static internal <a href='../sys/Int.html'>Int</a> CR := 13</code></p>
</dd>
<dt id='HT' class='field hidden'>HT<a href='WebUtil_src.html#HT'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>const static internal <a href='../sys/Int.html'>Int</a> HT := 9</code></p>
</dd>
<dt id='LF' class='field hidden'>LF<a href='WebUtil_src.html#LF'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>const static internal <a href='../sys/Int.html'>Int</a> LF := 10</code></p>
</dd>
<dt id='SP' class='field hidden'>SP<a href='WebUtil_src.html#SP'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>const static internal <a href='../sys/Int.html'>Int</a> SP := 32</code></p>
</dd>
<dt id='fromQuotedStr' class='method'>fromQuotedStr<a href='WebUtil_src.html#fromQuotedStr'>Source</a></dt>
<dd>
<p><code class='sig'>static <a href='../sys/Str.html'>Str</a> fromQuotedStr(<a href='../sys/Str.html'>Str</a> s)</code></p>

<p>Decode a HTTP quoted string according to RFC 2616 Section 2.2. The given string must be wrapped in quotes.  See <a href='WebUtil.html#toQuotedStr'>toQuotedStr</a>.</p>
</dd>
<dt id='isToken' class='method'>isToken<a href='WebUtil_src.html#isToken'>Source</a></dt>
<dd>
<p><code class='sig'>static <a href='../sys/Bool.html'>Bool</a> isToken(<a href='../sys/Str.html'>Str</a> s)</code></p>

<p>Return if the specified string is a valid HTTP token production which is any ASCII character which is not a control char or a separator.  The separators characters are:</p>

<pre>"(" | ")" | "&lt;" | ">" | "@" |
"," | ";" | ":" | "\" | &lt;"> |
"/" | "[" | "]" | "?" | "=" |
"{" | "}" | SP | HT</pre>
</dd>
<dt id='jsMain' class='method'>jsMain<a href='WebUtil_src.html#jsMain'>Source</a></dt>
<dd>
<p><code class='sig'>static <a href='../sys/Void.html'>Void</a> jsMain(<a href='../sys/OutStream.html'>OutStream</a> out, <a href='../sys/Str.html'>Str</a> main, [<a href='../sys/Str.html'>Str</a>:<a href='../sys/Str.html'>Str</a>]? env := null)</code></p>

<p>Generate the method invocation code used to boostrap into JavaScript from a webpage.  This <em>must</em> be called inside the <code>&lt;head></code> tag for the page.  The main method will be invoked using the <code>onLoad</code> DOM event.</p>

<p>The <code>main</code> argument can be either a type or method.  If no method is specified, <code>main</code> is used.  If the method is not static, a new instance of type is created:</p>

<pre>"foo::Instance"     =>  Instance().main()
"foo::Instance.bar" =>  Instance().bar()
"foo::Static"       =>  Static.main()
"foo::Static.bar"   =>  Static.bar()</pre>

<p>If <code>env</code> is specified, then vars will be added to and available from <code><a href='../sys/Env.html#vars'>sys::Env.vars</a></code> on client-side.</p>
</dd>
<dt id='makeChunkedInStream' class='method'>makeChunkedInStream<a href='WebUtil_src.html#makeChunkedInStream'>Source</a></dt>
<dd>
<p><code class='sig'>static <a href='../sys/InStream.html'>InStream</a> makeChunkedInStream(<a href='../sys/InStream.html'>InStream</a> in)</code></p>

<p>Wrap the given input stream to read bytes using a HTTP chunked transfer encoding.  The wrapped streams provides a contiguous stream of bytes until the last chunk is read. Closing the wrapper stream does not close the underlying stream.</p>
</dd>
<dt id='makeChunkedOutStream' class='method'>makeChunkedOutStream<a href='WebUtil_src.html#makeChunkedOutStream'>Source</a></dt>
<dd>
<p><code class='sig'>static <a href='../sys/OutStream.html'>OutStream</a> makeChunkedOutStream(<a href='../sys/OutStream.html'>OutStream</a> out)</code></p>

<p>Wrap the given output stream to write bytes using a HTTP chunked transfer encoding.  Closing the wrapper stream terminates the chunking, but does not close the underlying stream.</p>
</dd>
<dt id='makeContentInStream' class='method'>makeContentInStream<a href='WebUtil_src.html#makeContentInStream'>Source</a></dt>
<dd>
<p><code class='sig'>static <a href='../sys/InStream.html'>InStream</a>? makeContentInStream(<a href='../sys/Str.html'>Str</a>:<a href='../sys/Str.html'>Str</a> headers, <a href='../sys/InStream.html'>InStream</a> in)</code></p>

<p>Given a set of headers, wrap the specified input stream to read the content body:</p>

<ol style='list-style-type:decimal'>
<li>If Content-Length then <a href='WebUtil.html#makeFixedInStream'>makeFixedInStream</a></li>

<li>If Transfer-Encoding is chunked then <a href='WebUtil.html#makeChunkedInStream'>makeChunkedInStream</a></li>

<li>If Content-Type assume non-pipelined connection and return <code>in</code> directly</li>

<li>Assume no content and return null</li>
</ol>

<p>If a stream is returned, then it is automatically configured with the correct content encoding based on the Content-Type.</p>
</dd>
<dt id='makeContentOutStream' class='method'>makeContentOutStream<a href='WebUtil_src.html#makeContentOutStream'>Source</a></dt>
<dd>
<p><code class='sig'>static <a href='../sys/OutStream.html'>OutStream</a>? makeContentOutStream(<a href='../sys/Str.html'>Str</a>:<a href='../sys/Str.html'>Str</a> headers, <a href='../sys/OutStream.html'>OutStream</a> out)</code></p>

<p>Given a set of headers, wrap the specified output stream to write the content body:</p>

<ol style='list-style-type:decimal'>
<li>If Content-Length then <a href='WebUtil.html#makeFixedOutStream'>makeFixedOutStream</a></li>

<li>If Content-Type then set Transfer-Encoding header to chunked and return <a href='WebUtil.html#makeChunkedOutStream'>makeChunkedOutStream</a></li>

<li>Assume no content and return null</li>
</ol>

<p>If a stream is returned, then it is automatically configured with the correct content encoding based on the Content-Type.</p>
</dd>
<dt id='makeFixedInStream' class='method'>makeFixedInStream<a href='WebUtil_src.html#makeFixedInStream'>Source</a></dt>
<dd>
<p><code class='sig'>static <a href='../sys/InStream.html'>InStream</a> makeFixedInStream(<a href='../sys/InStream.html'>InStream</a> in, <a href='../sys/Int.html'>Int</a> fixed)</code></p>

<p>Wrap the given input stream to read a fixed number of bytes. Once <code>fixed</code> bytes have been read from the underlying input stream, the wrapped stream will return end-of-stream.  Closing the wrapper stream does not close the underlying stream.</p>
</dd>
<dt id='makeFixedOutStream' class='method'>makeFixedOutStream<a href='WebUtil_src.html#makeFixedOutStream'>Source</a></dt>
<dd>
<p><code class='sig'>static <a href='../sys/OutStream.html'>OutStream</a> makeFixedOutStream(<a href='../sys/OutStream.html'>OutStream</a> out, <a href='../sys/Int.html'>Int</a> fixed)</code></p>

<p>Wrap the given output stream to write a fixed number of bytes. Once <code>fixed</code> bytes have been written, attempting to further bytes will throw IOErr.  Closing the wrapper stream does not close the underlying stream.</p>
</dd>
<dt id='maxTokenSize' class='field hidden'>maxTokenSize<a href='WebUtil_src.html#maxTokenSize'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>const static internal <a href='../sys/Int.html'>Int</a> maxTokenSize := 4096</code></p>
</dd>
<dt id='parseHeaders' class='method'>parseHeaders<a href='WebUtil_src.html#parseHeaders'>Source</a></dt>
<dd>
<p><code class='sig'>static <a href='../sys/Str.html'>Str</a>:<a href='../sys/Str.html'>Str</a> parseHeaders(<a href='../sys/InStream.html'>InStream</a> in)</code></p>

<p>Parse a series of HTTP headers according to RFC 2616 section 4.2.  The final CRLF which terminates headers is consumed with the stream positioned immediately following.  The headers are returned as a <code><a href='../sys/Map.html#caseInsensitive'>case insensitive</a></code> map. Throw ParseErr if headers are malformed.</p>
</dd>
<dt id='parseList' class='method'>parseList<a href='WebUtil_src.html#parseList'>Source</a></dt>
<dd>
<p><code class='sig'>static <a href='../sys/Str.html'>Str</a>[] parseList(<a href='../sys/Str.html'>Str</a> s)</code></p>

<p>Parse a list of comma separated tokens.  Any leading or trailing whitespace is trimmed from the list of tokens.</p>
</dd>
<dt id='parseMultiPart' class='method'>parseMultiPart<a href='WebUtil_src.html#parseMultiPart'>Source</a></dt>
<dd>
<p><code class='sig'>static <a href='../sys/Void.html'>Void</a> parseMultiPart(<a href='../sys/InStream.html'>InStream</a> in, <a href='../sys/Str.html'>Str</a> boundary, |<a href='../sys/Str.html'>Str</a>:<a href='../sys/Str.html'>Str</a>, <a href='../sys/InStream.html'>InStream</a>| cb)</code></p>

<p>Parse a multipart/form-data input stream.  For each part in the stream call the given callback function with the part's headers and an input stream used to read the part's body.  Each callback must completely drain the input stream to prepare for the next part.</p>
</dd>
<dt id='toQuotedStr' class='method'>toQuotedStr<a href='WebUtil_src.html#toQuotedStr'>Source</a></dt>
<dd>
<p><code class='sig'>static <a href='../sys/Str.html'>Str</a> toQuotedStr(<a href='../sys/Str.html'>Str</a> s)</code></p>

<p>Return the specified string as a HTTP quoted string according to RFC 2616 Section 2.2.  The result is wrapped in quotes.  Throw ArgErr if any character is outside of the ASCII range of 0x20 to 0x7e.  The quote char itself is backslash escaped. See <a href='WebUtil.html#fromQuotedStr'>fromQuotedStr</a>.</p>
</dd>
<dt id='token' class='method hidden'>token<a href='WebUtil_src.html#token'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>static private <a href='../sys/Str.html'>Str</a> token(<a href='../sys/InStream.html'>InStream</a> in, <a href='../sys/Int.html'>Int</a> sep)</code></p>

<p>Read the next token from the stream up to the specified separator. We place a limit of 512 bytes on a single token. Consume the separate char too.</p>
</dd>
<dt id='tokenChars' class='field hidden'>tokenChars<a href='WebUtil_src.html#tokenChars'>Source</a></dt>
<dd class='hidden'>
<p><code class='sig'>const static private <a href='../sys/Bool.html'>Bool</a>[] tokenChars</code></p>
</dd>
</dl>
</div>
</div>
</div>
<div class='sidebar'>
<h2>Type</h2>
<ul class='clean'>
  <li><a href='WebUtil_src.html'>View Source</a></li>
  <li><a href='#' onclick='ShowSlots.toggle(event); return false;'>Show All Slots</a></li>
</ul>
<div class='slots'>
<div class='overview'>
<h2>Slots</h2>
<ul class='clean'>
  <li class='hidden'><a href='#CR'>CR</a></li>
  <li class='hidden'><a href='#HT'>HT</a></li>
  <li class='hidden'><a href='#LF'>LF</a></li>
  <li class='hidden'><a href='#SP'>SP</a></li>
  <li><a href='#fromQuotedStr'>fromQuotedStr</a></li>
  <li><a href='#isToken'>isToken</a></li>
  <li><a href='#jsMain'>jsMain</a></li>
  <li><a href='#makeChunkedInStream'>makeChunkedInStream</a></li>
  <li><a href='#makeChunkedOutStream'>makeChunkedOutStream</a></li>
  <li><a href='#makeContentInStream'>makeContentInStream</a></li>
  <li><a href='#makeContentOutStream'>makeContentOutStream</a></li>
  <li><a href='#makeFixedInStream'>makeFixedInStream</a></li>
  <li><a href='#makeFixedOutStream'>makeFixedOutStream</a></li>
  <li class='hidden'><a href='#maxTokenSize'>maxTokenSize</a></li>
  <li><a href='#parseHeaders'>parseHeaders</a></li>
  <li><a href='#parseList'>parseList</a></li>
  <li><a href='#parseMultiPart'>parseMultiPart</a></li>
  <li><a href='#toQuotedStr'>toQuotedStr</a></li>
  <li class='hidden'><a href='#token'>token</a></li>
  <li class='hidden'><a href='#tokenChars'>tokenChars</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class='footer'>
<div>
<p>
web 1.0.56
[11-Nov-2010 Thu 10:08:20AM EST]
</p>
</div>
</div>
</body>
</html>
