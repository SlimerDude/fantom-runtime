<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
 "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns='http://www.w3.org/1999/xhtml'>
<head>
  <title>compiler::ClosureExpr</title>
  <meta http-equiv='Content-Type' content='text/html; charset=UTF-8'/>
  <link rel='stylesheet' type='text/css' href='../doc.css'/>
  <script type='text/javascript' src='../doc.js'></script>
<!--[if lt IE 7]>
<script src='http://ie7-js.googlecode.com/svn/version/2.0(beta3)/IE7.js' type='text/javascript'></script>
<![endif]-->
</head>
<body onload='Login.check();'>
<div class='header'>
<div>
<h1><a href='/'>Fantom</a></h1>
<p id='sidewalkLogin_'>&nbsp;</p>
<form method='get' action='/sidewalk/search/'>
<p>
<input type='text' name='q' size='30' value='Search...' onfocus='if (value=="Search...") value=""' onblur='if (value=="") value="Search..."' />
</p>
</form>
<ul>
<li><a href='/'>Home</a></li>
<li class='active'><a href='../index.html'>Docs</a></li>
<li><a href='/sidewalk/blog/'>Blog</a></li>
<li><a href='/sidewalk/ticket/'>Tickets</a></li>
<li><a href='/sidewalk/topic/'>Discuss</a></li>
</ul></div>
</div>
<div class='subHeader'>
<div>
<ul>
  <li><a href='../index.html'>Doc Home</a></li>
  <li>&gt;</li>
  <li><a href='index.html'>compiler</a></li>
  <li>&gt;</li>
  <li><a href='ClosureExpr.html'>ClosureExpr</a></li>
</ul>
</div>
</div>
<div class='content'>
<div>
<div class='fandoc'>
<div class='type'>
<div class='overview'>
<h2>class</h2>
<h1>compiler::ClosureExpr</h1>
<pre><a href='../sys/Obj.html'>sys::Obj</a>
  <a href='Node.html'>compiler::Node</a>
    <a href='Expr.html'>compiler::Expr</a>
      compiler::ClosureExpr</pre>
</div>
<div class='detail'>

<p>ClosureExpr is an "inlined anonymous method" which closes over it's lexical scope.  ClosureExpr is placed into the AST by the parser with the code field containing the method implementation.  In InitClosures we remap a ClosureExpr to an anonymous class TypeDef which extends Func.  The function implementation is moved to the anonymous class's doCall() method.  However we leave ClosureExpr in the AST in it's original location with a substitute expression. The substitute expr just creates an instance of the anonymous class. But by leaving the ClosureExpr in the tree, we can keep track of the original lexical scope of the closure.</p>
</div>
</div>
<div class='slots'>
<div class='detail'>
<h2>Slots</h2>
<dl>
<dt id='call' class='field'>call<a href='ClosureExpr_src.html#call'>Source</a></dt>
<dd>
<p><code class='sig'><a href='MethodDef.html'>MethodDef</a>? call</code></p>
</dd>
<dt id='cls' class='field'>cls<a href='ClosureExpr_src.html#cls'>Source</a></dt>
<dd>
<p><code class='sig'><a href='TypeDef.html'>TypeDef</a>? cls</code></p>
</dd>
<dt id='code' class='field'>code<a href='ClosureExpr_src.html#code'>Source</a></dt>
<dd>
<p><code class='sig'><a href='Block.html'>Block</a>? code</code></p>
</dd>
<dt id='collapseExprAndReturn' class='method'>collapseExprAndReturn<a href='ClosureExpr_src.html#collapseExprAndReturn'>Source</a></dt>
<dd>
<p><code class='sig'><a href='../sys/Void.html'>Void</a> collapseExprAndReturn(<a href='MethodDef.html'>MethodDef</a> m)</code></p>
</dd>
<dt id='doCall' class='field'>doCall<a href='ClosureExpr_src.html#doCall'>Source</a></dt>
<dd>
<p><code class='sig'><a href='MethodDef.html'>MethodDef</a>? doCall</code></p>
</dd>
<dt id='enclosingClosure' class='field'>enclosingClosure<a href='ClosureExpr_src.html#enclosingClosure'>Source</a></dt>
<dd>
<p><code class='sig'><a href='ClosureExpr.html'>ClosureExpr</a>? enclosingClosure</code></p>
</dd>
<dt id='enclosingSlot' class='field'>enclosingSlot<a href='ClosureExpr_src.html#enclosingSlot'>Source</a></dt>
<dd>
<p><code class='sig'><a href='SlotDef.html'>SlotDef</a> enclosingSlot</code></p>
</dd>
<dt id='enclosingType' class='field'>enclosingType<a href='ClosureExpr_src.html#enclosingType'>Source</a></dt>
<dd>
<p><code class='sig'><a href='TypeDef.html'>TypeDef</a> enclosingType</code></p>
</dd>
<dt id='enclosingVars' class='field'>enclosingVars<a href='ClosureExpr_src.html#enclosingVars'>Source</a></dt>
<dd>
<p><code class='sig'>[<a href='../sys/Str.html'>Str</a>:<a href='MethodVar.html'>MethodVar</a>]? enclosingVars</code></p>
</dd>
<dt id='isItBlock' class='field'>isItBlock<a href='ClosureExpr_src.html#isItBlock'>Source</a></dt>
<dd>
<p><code class='sig'><a href='../sys/Bool.html'>Bool</a> isItBlock</code></p>
</dd>
<dt id='itType' class='field'>itType<a href='ClosureExpr_src.html#itType'>Source</a></dt>
<dd>
<p><code class='sig'><a href='CType.html'>CType</a>? itType</code></p>
</dd>
<dt id='make' class='method'>make<a href='ClosureExpr_src.html#make'>Source</a></dt>
<dd>
<p><code class='sig'>new make(<a href='Loc.html'>Loc</a> loc, <a href='TypeDef.html'>TypeDef</a> enclosingType, <a href='SlotDef.html'>SlotDef</a> enclosingSlot, <a href='ClosureExpr.html'>ClosureExpr</a>? enclosingClosure, <a href='FuncType.html'>FuncType</a> signature, <a href='../sys/Str.html'>Str</a> name)</code></p>
</dd>
<dt id='name' class='field'>name<a href='ClosureExpr_src.html#name'>Source</a></dt>
<dd>
<p><code class='sig'><a href='../sys/Str.html'>Str</a> name</code></p>
</dd>
<dt id='outerThisField' class='method'>outerThisField<a href='ClosureExpr_src.html#outerThisField'>Source</a></dt>
<dd>
<p><code class='sig'><a href='CField.html'>CField</a> outerThisField()</code></p>
</dd>
<dt id='print' class='method'>print<a href='ClosureExpr_src.html#print'>Source</a></dt>
<dd>
<p><code class='sig'>override <a href='../sys/Void.html'>Void</a> print(<a href='AstWriter.html'>AstWriter</a> out)</code></p>
<div class='slotInfo'>
<p>Overrides <a href='Expr.html#print'>compiler::Expr.print</a></p>
<p>Doc inherited from <a href='Node.html#print'>compiler::Node.print</a></p>
</div>

<p>Pretty print this node and it's descendants.</p>
</dd>
<dt id='setInferredSignature' class='method'>setInferredSignature<a href='ClosureExpr_src.html#setInferredSignature'>Source</a></dt>
<dd>
<p><code class='sig'><a href='../sys/Void.html'>Void</a> setInferredSignature(<a href='FuncType.html'>FuncType</a> t)</code></p>
</dd>
<dt id='setsConst' class='field'>setsConst<a href='ClosureExpr_src.html#setsConst'>Source</a></dt>
<dd>
<p><code class='sig'><a href='../sys/Bool.html'>Bool</a> setsConst</code></p>
</dd>
<dt id='signature' class='field'>signature<a href='ClosureExpr_src.html#signature'>Source</a></dt>
<dd>
<p><code class='sig'><a href='FuncType.html'>FuncType</a> signature</code></p>
</dd>
<dt id='substitute' class='field'>substitute<a href='ClosureExpr_src.html#substitute'>Source</a></dt>
<dd>
<p><code class='sig'><a href='CallExpr.html'>CallExpr</a>? substitute</code></p>
</dd>
<dt id='toStr' class='method'>toStr<a href='ClosureExpr_src.html#toStr'>Source</a></dt>
<dd>
<p><code class='sig'>override <a href='../sys/Str.html'>Str</a> toStr()</code></p>
<div class='slotInfo'>
<p>Overrides <a href='Expr.html#toStr'>compiler::Expr.toStr</a></p>
<p>Doc inherited from <a href='../sys/Obj.html#toStr'>sys::Obj.toStr</a></p>
</div>

<p>Return a string representation of this object.</p>
</dd>
<dt id='toWith' class='method'>toWith<a href='ClosureExpr_src.html#toWith'>Source</a></dt>
<dd>
<p><code class='sig'><a href='Expr.html'>Expr</a> toWith(<a href='Expr.html'>Expr</a> target)</code></p>
</dd>
</dl>
</div>
</div>
</div>
<div class='sidebar'>
<h2>Type</h2>
<ul class='clean'>
  <li><a href='ClosureExpr_src.html'>View Source</a></li>
  <li><a href='#' onclick='ShowSlots.toggle(event); return false;'>Show All Slots</a></li>
</ul>
<div class='slots'>
<div class='overview'>
<h2>Slots</h2>
<ul class='clean'>
  <li><a href='#call'>call</a></li>
  <li><a href='#cls'>cls</a></li>
  <li><a href='#code'>code</a></li>
  <li><a href='#collapseExprAndReturn'>collapseExprAndReturn</a></li>
  <li><a href='#doCall'>doCall</a></li>
  <li><a href='#enclosingClosure'>enclosingClosure</a></li>
  <li><a href='#enclosingSlot'>enclosingSlot</a></li>
  <li><a href='#enclosingType'>enclosingType</a></li>
  <li><a href='#enclosingVars'>enclosingVars</a></li>
  <li><a href='#isItBlock'>isItBlock</a></li>
  <li><a href='#itType'>itType</a></li>
  <li><a href='#make'>make</a></li>
  <li><a href='#name'>name</a></li>
  <li><a href='#outerThisField'>outerThisField</a></li>
  <li><a href='#print'>print</a></li>
  <li><a href='#setInferredSignature'>setInferredSignature</a></li>
  <li><a href='#setsConst'>setsConst</a></li>
  <li><a href='#signature'>signature</a></li>
  <li><a href='#substitute'>substitute</a></li>
  <li><a href='#toStr'>toStr</a></li>
  <li><a href='#toWith'>toWith</a></li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class='footer'>
<div>
<p>
compiler 1.0.56
[11-Nov-2010 Thu 10:08:16AM EST]
</p>
</div>
</div>
</body>
</html>
